
<div class="enc-content">
    <div class="container">
        <%= render "top_nav_buttons"%>
        <div class="mt-4">
            <div class="d-flex align-items-center gap-3">
                <a href="<%= mhc_verification_platform_path(page_tab: 'education')%>" class="link-back">
                    <i class='bx bx-left-arrow-alt'></i>
                </a>
                <h4 class="page-heading">Education Record</h4>
            </div>
        </div>
        <div class="row">
            <div class="col-xl-8 row">
                <%= form_with model: [:mhc, @practice_information_education] do |f| %>
                    <%= f.hidden_field :caqh_provider_attest_id %>
                    <%= f.hidden_field :provider_attest_id %>
                    <div class="form-row row page-applicable mt-3">
                        <span class="page-note">
                            <i class='bx bx-error-circle font-lightblue'></i> <span>To search for a School name,
                                please
                                click the search button.</span>
                        </span>
                        <div class="col-12">
                            <label class="text-dark-grey">School:</label>
                            <div class="row">
                                <div class="col-10">
                                    <%= f.text_field :institution_name,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                                </div>
                                <div class="col-2">
                                    <button id="search_school_button" type="button" class="btn btn-primary btn-sm" id="asdf" style="min-width: 100px; font-size: 12px" data-bs-toggle="modal" data-bs-target="#search_school">
                                        Search
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <label class="text-dark-grey">Address:</label>
                            <%= f.text_field :address,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-12">
                            <label class="text-dark-grey">Suite/Dept/Mail Stop:</label>
                            <%= f.text_field :suite_dept_mail_stop,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-12">
                            <label class="text-dark-grey">Additional Address:</label>
                            <%= f.text_field :address2,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">City:</label>
                            <%= f.text_field :city,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">County:</label>
                            <%= f.text_field :county,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">Country:</label>
                            <%= f.text_field :country,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">Province:</label>
                            <%= f.text_field :province,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">State:</label>
                            <%= f.text_field :state,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">Postal Code:</label>
                            <%= f.text_field :postal_code,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">Email Address:</label>
                            <%= f.text_field :email_address,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">Phone Number:</label>
                            <%= f.text_field :phone_number,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">Fax Number:</label>
                            <%= f.text_field :fax_number,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">Program Title</label>
                            <%= f.text_field :program_title,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">Degree/Certificate Received:</label>
                            <%= f.text_field :degree_degree_abbreviation,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">If Other, please fill:</label>
                            <%= f.text_field :if_other_list,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">Start Date:</label>
                            <%= f.date_field :start_date, placeholder: 'Select a date...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">End Date:</label>
                            <%= f.date_field :end_date, placeholder: 'Select a date...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-12">
                            <div>
                                <%= f.label :program_completed_flag, "Completed?" %>
                                <%= f.check_box :program_completed_flag %>
                            </div>
                        </div>
                        <div class="col-12">
                            <label class="text-dark-grey">Incomplete Explanation:</label>
                            <%= f.text_field :incomplete_explanation,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-12">
                            <label class="text-dark-grey">Please list any comments:</label>
                            <%= f.text_field :comments,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div>
                        <%= f.label :show_on_tickler, "Show On Tickler?" %>
                        <%= f.check_box :show_on_tickler, class: "form-check-input" %>
                        </div>
                        <div class="col-12 text-left" style="margin-top: 20px;">
                            <%= f.submit 'Save', class: 'btn btn-primary', style: 'width: 200px;' %>
                        </div>
                    </div>
                <% end %>
              <% if @practice_information_education.persisted? %>
                  <div class="col-12 text-left" style="margin-top: 10px;">
                      <%= button_to 'Delete', 
                          mhc_practice_information_education_path(@practice_information_education, provider_attest_id: @practice_information_education.provider_attest_id), 
                          method: :delete, 
                          data: { confirm: 'Are you sure you want to delete this education detail?' }, 
                          class: 'btn btn-danger', 
                          style: 'width: 200px;' %>
                  </div>
              <% end %>
            </div>
            <% if @practice_information_education.persisted? %>
                <div class="col-xl-4 p-2 text-center">
                    <div class="row">
                        <div class="col-12 m-2">
                            <button class="btn btn-primary btn-sm" style="min-width: 100px; font-size: 12px" disabled>
                                Verification Letter
                            </button>
                        </div>
                        <div class="col-12 m-2">
                            <button  type="button" class="btn btn-primary btn-sm" id="asdf" style="min-width: 100px; font-size: 12px" data-bs-toggle="modal" data-bs-target="#send_contact_template">
                                Send Contact
                            </button>
                        </div>
                    </div>
                    <div class="card other-name-card">
                        <div class="card-body">
                            <h2 class="">RVA Information</h2>
                            <div class="mt-3 row">
                                <div class="col-12 m-2">
                                    <button class="btn btn-primary btn-sm" style="min-width: 100px; font-size: 12px" disabled>
                                        Request
                                    </button>
                                </div>
                                <div class="col-12 m-2">
                                    <button class="btn btn-primary btn-sm" style="min-width: 100px; font-size: 12px" disabled>
                                        Verification
                                    </button>
                                </div>
                                <div class="col-12 m-2">
                                    <button class="btn btn-primary btn-sm" style="min-width: 100px; font-size: 12px" disabled>
                                        Audit
                                    </button>
                                </div>
                                <div class="col-12 m-2">
                                     <button class="btn btn-primary btn-audit btn-sm" data-bs-toggle="modal" data-bs-target="#QAModal" data-information-id="<%= @last_rva_information&.id %>" data-first-name="<%= @provider_personal_information&.first_name %>" data-last-name="<%= @provider_personal_information&.last_name %>" data-personal-information-id="<%= @provider_personal_information&.id %>" data-education-id = "<%= @practice_information_education.id%>">
                                          Quality Audit
                                    </button>
                                </div>
                                <div class="col-12 m-2">
                                    <button class="btn btn-primary btn-sm" style="min-width: 100px; font-size: 12px" data-information-id="<%= @last_rva_information&.id %>" data-personal-information-id="<%= @provider_personal_information&.id %>" data-education-id = "<%= @practice_information_education.id %>" id="skip-rva-btn">
                                        Skip RVA
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12 m-2">
                            <button class="btn btn-primary btn-sm" style="min-width: 100px; font-size: 12px" disabled>
                                View Scanned Images
                            </button>
                        </div>
                    </div>
                    <div class="card other-name-card">
                        <div class="card-body">
                            <h2 class="">Message Board</h2>
                            <div class="mt-3 row">
                                <div class="col-12 m-2">
                                    <ul style="list-style: none;overflow:scroll; height:400px;">
                                        <% if @provider_personal_information_comments.present? %>
                                            <% @provider_personal_information_comments.each do |comment| %>
                                                <li class="mt-2">
                                                <span class="btn bg-alt-grey py-1" 
                                                    data-bs-toggle="modal" 
                                                    data-bs-target="#deleteCommentModal" 
                                                    data-comment-id="<%= comment.id %>"
                                                    data-comment-subject= "<%= comment.subject %>"
                                                    data-comment-message= "<%= comment.message %>">
                                                    Subject : <%= comment.subject %>
                                                    <p><%= comment.user.first_name %> </p>
                                                </span>
                                                <span class="btn py-1">
                                                <%= button_to mhc_provider_personal_information_comment_path(comment.id), method: :delete, class: 'btn btn-danger' do %>
                                                    <i class="bx bx-trash"></i>
                                                <% end %>
                                                </span>
                                                </li>
                                            <% end %> 
                                        <% else %>
                                            <p class="btn bg-alt-grey py-1">No comment yet!</p>
                                        <% end %>
                                    </ul>
                                </div>
                                <div class="col-12 m-2">
                                    <button type="button" class="btn btn-primary btn-sm" style="min-width: 100px; font-size: 12px" data-bs-toggle="modal" data-bs-target="#addCommentModal">
                                        Add Comment
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            <% end %>
        </div>
    </div>
</div>

<!-- Add Comment Modal -->
<div class="modal fade" id="addCommentModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body">
                <div class="content">
                    <div class="modal-title">
                        <h6 class="offset-md-5">Add Comment</h6>
                        <button class="btn btn-cancel" data-bs-dismiss="modal">Cancel</button>
                    </div>
                    <%= form_with(model: @provider_personal_information_comment, url: mhc_provider_personal_information_comments_path, method: :post) do |f| %>

                        <%= f.hidden_field :provider_personal_information_id, value: @provider_personal_information.id %>
                        <%= f.hidden_field :page_tab, value: 'education_record' %>
                        <div class="form-row mt-3">
                        <label for="provider_personal_information_comment_subject">Subject:</label>
                        <%= f.text_field :subject, class: "form-control" %>
                        </div>

                        <div class="form-row">
                        <label for="provider_personal_information_comment_message">Message:</label>
                        <%= f.text_area :message, class: "form-control", rows: 5 %>
                        </div>

                        <div class="form-row mt-3 d-flex justify-content-center">
                        <%= f.submit 'Post Comment', class: 'btn btn-primary' %>
                        </div>
                    <% end %>


                    <%# <form action="">
                        <div class="form-row mt-3">
                            <label for="">Subject:</label>
                            <input type="text" class="form-control">
                        </div>
                        <div class="form-row">
                            <label for="">Message:</label>
                            <textarea name="" id="" cols="30" rows="5" class="form-control"></textarea>
                        </div>
                    </form>
                    <div class="form-row mt-3 d-flex justify-content-center">
                        <button class="btn btn-primary">Post Comment</button>
                    </div> %>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="search_school" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered">
        <div class="modal-content">
            <div class="p-4">
                <h2 class="text-center">Search For School</h3>
                <div class="card other-name-card">
                    <div class="card-body">
                        <span class="page-note">
                            <i class='bx bx-error-circle font-lightblue'></i> <span>
                            To search for an existing school, please select the Country, State or Province, City and School from the drop down lists. If your School is not on the list, click the New button. Complete the requested address information of the department or office that may verify your degree or certificate. Click the Save button. Click the Close button to populate the record with the new address information.</span>
                        </span>
                        <div class="col-xl-12">
                            <form accept-charset="UTF-8" action=<%= get_schools_url %> method="POST" id="search_school_form" class="form_search_with_icon m-3">
                                <div class="form-row row">
                                    <div class="col-12">
                                        <label for="state">State:</label>
                                        <div class="search-select form-control border border-dark" name="q[state_eq]" id="search_school_form_state">
                                        </div>
                                    </div>
                                    <div class="col-12">
                                        <label for="name">School:</label>
                                        <input type="text" class="form-control" id="search_school_form_name_cont" name="q[name_cont]" placeholder="Search Education record by name" aria-label="Search Education record" aria-describedby="basic-addon2">
                                    </div>
                                </div>
                                <div class="text-center mt-2">
                                    <button class="btn btn-primary" type="submit"  form="search_school_form">Search</button>
                                </div>
                            </form>

                            <div class="form-row row p-2 text-center m-auto">
                                <div class="col-12">
                                    <label for="state">Search Result School list:</label>
                                    <div class="search-select form-control border border-dark" name="result_school" id="result_school_list">
                                    </div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="m-2">
                                    <div class="form-row row">
                                        <div class="col-xl-6 ">
                                            <label for="name">School:</label>
                                            <input type="text" name="name" id="search_school_name" class="form-control form-control-lg"
                                                placeholder="Type here.." disabled="true">
                                        </div>
                                        <div class="col-xl-6">
                                            <label for="address">Address:</label>
                                            <input type="text" name="address" id="search_school_address" class="form-control form-control-lg"
                                                placeholder="Type here.." disabled="true">
                                        </div>
                                    </div>
                                    <div class="form-row row">
                                        <div class="col-xl-6">
                                            <label for="suite">Suite/Mail Stop:</label>
                                            <input type="text" name="suite" id="search_school_suite" class="form-control form-control-lg"
                                                placeholder="Type here.." disabled="true">
                                        </div>
                                        <div class="col-xl-6">
                                            <label for="address2">Additional Address:</label>
                                            <input type="text" name="address2" id="search_school_address2"
                                                class="form-control form-control-lg" placeholder="Type here.." disabled="true">
                                        </div>
                                    </div>
                                    <div class="form-row row">
                                        <div class="col-xl-6">
                                            <label for="city">City:</label>
                                            <input type="text" name="city" id="search_school_city" class="form-control form-control-lg"
                                                placeholder="Type here.." disabled="true">
                                        </div>
                                        <div class="col-xl-6">
                                            <label for="county">County:</label>
                                            <input type="text" name="county" id="search_school_county" class="form-control form-control-lg"
                                                placeholder="Type here.." disabled="true">
                                        </div>
                                    </div>
                                    <div class="form-row row">
                                        <div class="col-xl-4">
                                            <label for="state">State/Province:</label>
                                            <input type="text" name="state" id="search_school_state" class="form-control form-control-lg"
                                                placeholder="Type here.." disabled="true">
                                        </div>
                                        <div class="col-xl-4">
                                            <label for="postal_code">Zip/Postal Code:</label>
                                            <input type="text" name="postal_code" id="search_school_postal_code" class="form-control form-control-lg"
                                                placeholder="Type here.." disabled="true">
                                        </div>
                                        <div class="col-xl-4">
                                            <label for="country">Country:</label>
                                            <input type="text" name="country" id="search_school_country" class="form-control form-control-lg"
                                                placeholder="Type here.." disabled="true">
                                        </div>
                                    </div>
                                    <div class="form-row row">
                                        <div class="col-xl-4">
                                            <label for="phone">Phone Number:</label>
                                            <input type="text" name="phone" id="search_school_phone" class="form-control form-control-lg"
                                                placeholder="Type here.." disabled="true">
                                        </div>
                                        <div class="col-xl-4">
                                            <label for="email">Email Address:</label>
                                            <input type="text" name="email" id="search_school_email" class="form-control form-control-lg"
                                                placeholder="Type here.." disabled="true">
                                        </div>
                                        <div class="col-xl-4">
                                            <label for="fax">Fax Number:</label>
                                            <input type="text" name="fax" id="search_school_fax" class="form-control form-control-lg"
                                                placeholder="Type here.." disabled="true">
                                        </div>
                                    </div>
                                    <div class="form-row row">
                                        <div class="col-xl-4">
                                            <label for="fax">Contact Method:</label>
                                            <input type="text" name="contact_method" id="search_school_contact_method" class="form-control form-control-lg"
                                                placeholder="Type here.." disabled="true">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="text-center mt-2">
                            <button type="submit" id="confirm_school_button" class="btn btn-success">Confirm</button>
                        </div>
                    </div>
                </div>
                <div class="text-center mt-2">
                    <button type="button" class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#add_school">
                        New
                    </button>
                </div>
                <button class="btn btn-cancel w-100" data-bs-dismiss="modal" id="btn-modal-close">Cancel</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="add_school" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered">
        <div class="modal-content">
            <div class="p-4">
                <h2 class="text-center">Add New School</h3>
                <div class="card other-name-card">
                    <div class="card-body">
                        <div class="col-xl-12">
                            <div class="card">
                                <form accept-charset="UTF-8" action=<%= mhc_schools_url %> method="POST" id="add_school_form" class="form_search_with_icon">
                                    <div class="m-2">
                                        <div class="form-row row">
                                            <div class="col-xl-6 ">
                                                <label for="name">School:</label>
                                                <input type="text" name="name" id="add_school_name" class="form-control form-control-lg"
                                                    placeholder="Type here..">
                                            </div>
                                            <div class="col-xl-6">
                                                <label for="address">Address:</label>
                                                <input type="text" name="address" id="add_school_address" class="form-control form-control-lg"
                                                    placeholder="Type here..">
                                            </div>
                                        </div>
                                        <div class="form-row row">
                                            <div class="col-xl-6">
                                                <label for="suite">Suite/Mail Stop:</label>
                                                <input type="text" name="suite" id="add_school_suite" class="form-control form-control-lg"
                                                    placeholder="Type here..">
                                            </div>
                                            <div class="col-xl-6">
                                                <label for="address2">Additional Address:</label>
                                                <input type="text" name="address2" id="add_school_address2"
                                                    class="form-control form-control-lg" placeholder="Type here..">
                                            </div>
                                        </div>
                                        <div class="form-row row">
                                            <div class="col-xl-6">
                                                <label for="city">City:</label>
                                                <input type="text" name="city" id="add_school_city" class="form-control form-control-lg"
                                                    placeholder="Type here..">
                                            </div>
                                            <div class="col-xl-6">
                                                <label for="county">County:</label>
                                                <input type="text" name="county" id="add_school_county" class="form-control form-control-lg"
                                                    placeholder="Type here..">
                                            </div>
                                        </div>
                                        <div class="form-row row">
                                            <div class="col-xl-4">
                                                <label for="state">State/Province:</label>
                                                <div class="search-select form-control border border-dark" name="state" id="add_school_state">
                                                </div>
                                            </div>
                                            <div class="col-xl-4">
                                                <label for="postal_code">Zip/Postal Code:</label>
                                                <input type="text" name="postal_code" id="add_school_postal_code" class="form-control form-control-lg"
                                                    placeholder="Type here..">
                                            </div>
                                            <div class="col-xl-4">
                                                <label for="country">Country:</label>
                                                <input type="text" name="country" id="add_school_country" class="form-control form-control-lg"
                                                    placeholder="Type here..">
                                            </div>
                                        </div>
                                        <div class="form-row row">
                                            <div class="col-xl-4">
                                                <label for="phone">Phone Number:</label>
                                                <input type="text" name="phone" id="add_school_phone" class="form-control form-control-lg"
                                                    placeholder="Type here..">
                                            </div>
                                            <div class="col-xl-4">
                                                <label for="email">Email Address:</label>
                                                <input type="text" name="email" id="add_school_email" class="form-control form-control-lg"
                                                    placeholder="Type here..">
                                            </div>
                                            <div class="col-xl-4">
                                                <label for="fax">Fax Number:</label>
                                                <input type="text" name="fax" id="add_school_fax" class="form-control form-control-lg"
                                                    placeholder="Type here..">
                                            </div>
                                        </div>
                                        <div class="form-row row">
                                            <div class="col-xl-4">
                                                <label for="fax">Contact Method:</label>
                                                <select id="add_school_contact_method" name="contact_method" class="form-select">
                                                    <option value="email" selected>Email</option>
                                                    <option value="letter">Letter</option>
                                                    <option value="fax">Fax</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <button type="submit" class="btn btn-primary btn-md w-100">
                                        <strong>Save</strong>
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <button class="btn btn-cancel w-100" data-bs-dismiss="modal" id="btn-modal-close">Cancel</button>
            </div>
        </div>
    </div>
</div>

            <div class="modal fade" id="QAModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
              <div class="modal-dialog modal-lg">
                <div class="modal-content">
                  <div class="modal-body">
                    <div id="qaModalMessage" class="alert alert-info d-none"></div>
                    <div class="content">
                      <div class="modal-title">
                        <h6 class="">Quality Audit</h6>
                        <button class="btn btn-cancel" data-bs-dismiss="modal">Cancel</button>
                      </div>
                      <%= form_with model: @rva_information, url: mhc_verification_platform_generate_rva_information_path, method: :post, id: 'audit-form' do |f| %>

                        <%= hidden_field_tag :id, @last_rva_information&.id %>
                        <%= hidden_field_tag :personal_info_id %>
                        <%= hidden_field_tag :practice_info_education_id %>

                        <%= hidden_field_tag :first_name %>
                        <%= hidden_field_tag :last_name %>
                        <div class="form-row row mt-3">
                          <div class="col-xl-12">
                            <div class="card other-name-card">
                              <div class="card-header bg-secondary rounded-0">
                                <h6 class="form-heading text-white">Request</h6>
                              </div>
                              <div class="card-body">
                                <div class="d-flex justify-content-end gap-2">
                                  <button class="btn btn-primary py-1" type="button">View Request History</button>
                                  <button class="btn btn-primary py-1" type="button">View Webcrawler Image Archive</button>
                                </div>
                                <hr class="form-hr">
                                <div class="row pt-3 pb-3">
                                  <div class="col-md-6">
                                    <button class="btn btn-sm btn-light <%= @last_rva_information.present? ? '' : 'btn-disabled' %>" 
                                            id="send-request-btn" 
                                            <%= 'disabled' if @last_rva_information.present? %>>
                                      Send Request
                                    </button>

                                  </div>
                                  <div class="col-md-6">
                                    <span class="font-bold sent-request" style="line-height: 38px;"><%= @last_rva_information&.send_request %></span>
                                  </div>
                                </div>
                                <hr class="form-hr">
                                <div class="row">
                                  <div class="col-md-6">
                                    <label for="">Requested By:</label>
                                  </div>
                                  <div class="col-md-6">
                                    <span class="font-bold requested-by"><%= @last_rva_information&.requested_by %></span>
                                  </div>
                                </div>
                                <hr class="form-hr">
                                <div class="row">
                                  <div class="col-md-6">
                                    <label for="">Requested Date:</label>
                                  </div>
                                  <div class="col-md-6">
                                    <span class="font-bold requested-date"><%= @last_rva_information&.requested_date %></span>
                                  </div>
                                </div>
                                <hr class="form-hr">
                                <div class="form-row d-flex align-items-center gap-3">
                                  <label for="">Requested Method:</label>
                                  <%= f.radio_button :requested_method, 'AutoFax', id: 'method-autofax', checked: (@last_rva_information.present? && @last_rva_information.requested_method == "AutoFax") %>
                                <label class="form-check-label" for="method-autofax">AutoFax</label>

                                <%= f.radio_button :requested_method, 'E-Mail', id: 'method-email', checked: (@last_rva_information.present? && @last_rva_information.requested_method == "E-Mail") %>
                                <label class="form-check-label" for="method-email">E-Mail</label>

                                <%= f.radio_button :requested_method, 'Letter', id: 'method-letter', checked: (@last_rva_information.present? && @last_rva_information.requested_method == "Letter") %>
                                <label class="form-check-label" for="method-letter">Letter</label>

                                <%= f.radio_button :requested_method, 'Phone', id: 'method-phone', checked: (@last_rva_information.present? && @last_rva_information.requested_method == "Phone") %>
                                <label class="form-check-label" for="method-phone">Phone</label>

                                <%= f.radio_button :requested_method, 'Website', id: 'method-website', checked: (@last_rva_information.present? && @last_rva_information.requested_method == "Website") %>
                                <label class="form-check-label" for="method-website">Website</label>
                                </div>
                                <span>The default contact method is letter.</span>
                                <hr class="form-hr">
                                <div class="form-row row">
                                  <div class="col-xl-6">
                                    <%= f.label :required_fee_amount, "Required Fee Amount:" %>
                                    <%= f.text_field :required_fee_amount, 
                                     class: 'form-control req-fee-amount', 
                                     placeholder: "Type here...", 
                                     value: @last_rva_information&.required_fee_amount, 
                                     disabled: true %>
                                  </div>
                                  <div class="col-xl-6">
                                    <%= f.label :check_payable_to, "Check Payable To:" %>
                                    <%= f.text_field :check_payable_to, 
                                     class: 'form-control', 
                                     placeholder: "Type here...", 
                                     value: @last_rva_information&.check_payable_to, 
                                     disabled: true %>
                                  </div>
                                </div>
                                <hr class="form-hr">
                                <div class="form-row mt-2">
                                  <%= f.check_box :include_delineation, 
                                    id: 'inc-delineation-check', 
                                    value: "Include Delineation of Privileges", 
                                    checked: @last_rva_information&.include_delineation == true %>

                                  <%= f.label :include_delineation, "Include Delineation of Privileges", for: 'inc-delineation-check' %>
                                </div>
                                <hr class="form-hr">
                                <div class="form-row d-flex align-items-center gap-3">
                                  <label for="">Check has generated?</label>
                                  
                                  <%= f.radio_button :check_generated, 'true', 
                                                      id: 'check-generate-yes', 
                                                      disabled: true, 
                                                      checked: @last_rva_information&.check_generated == true %>
                                  <label for="check-generate-yes">Yes</label>

                                  <%= f.radio_button :check_generated, 'false', 
                                                      id: 'check-generate-no', 
                                                      disabled: true, 
                                                      checked: @last_rva_information&.check_generated == false %>
                                  <label for="check-generate-no">No</label>
                                </div>

                                <hr class="form-hr">
                                <div class="form-row d-flex align-items-center gap-3">
                                  <label for="">Received Status:</label>

                                  <%= f.radio_button :received_status, 'Yes', 
                                                      id: 'received-status-yes', 
                                                      disabled: true, 
                                                      checked: @last_rva_information&.received_status == 'Yes' %>
                                  <label for="received-status-yes">Yes</label>

                                  <%= f.radio_button :received_status, 'No', 
                                                      id: 'received-status-no', 
                                                      disabled: true, 
                                                      checked: @last_rva_information&.received_status == 'No' %>
                                  <label for="received-status-no">No</label>
                                </div>

                                <hr class="form-hr">
                                <div class="row">
                                  <div class="col-md-6">
                                    <label for="">Received by:</label>
                                  </div>
                                  <div class="col-md-6">
                                    <span class="font-bold received-by">
                                      <%= @last_rva_information&.received_by.presence || ' ' %>
                                    </span>
                                  </div>
                                </div>
                                <hr class="form-hr">
                                <div class="row">
                                  <div class="col-md-6">
                                    <label for="">Received date:</label>
                                  </div>
                                  <div class="col-md-6">
                                    <span class="font-bold received-date">
                                      <%= @last_rva_information&.received_date.presence || ' ' %>
                                    </span>
                                  </div>
                                </div>
                                <hr class="form-hr">
                                <div class="form-row">
                                  <%= f.label :comments, "Comments:" %>
                                  <%= f.text_area :comments, rows: 3, class: 'form-control request-comment', value: @last_rva_information&.comments%>
                                </div>
                                <div class="form-row d-flex justify-content-end gap-2 mt-3">
                                  <button class="btn btn-primary py-1" type="button">View Received Images</button>
                                  <button class="btn btn-primary py-1" type="button" <%= 'disabled' if @last_rva_information.present? %>>Save Request</button>
                                  <button class="btn btn-primary py-1" type="button" <%= 'disabled' if !@last_rva_information.present? %>>Restart Request</button>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>

                        <div class="form-row row mt-3">
                          <div class="col-xl-12">
                            <div class="card other-name-card">
                              <div class="card-header bg-secondary rounded-0">
                                <h6 class="form-heading text-white">Verification</h6>
                              </div>  
                              <div class="card-body">
                                <div class="form-row row">
                                  <div class="col-md-6">
                                    <%= f.label :source_name, 'Source Name:' %>
                                  </div>
                                  <div class="col-md-6">  
                                    <%= f.select :source_name, options_for_select([['ADA', 'ADA'] , ['AMA Profile', 'AMA Profile'], ['AOA Profile', 'AOA Profile'], ['Application / On File with State Board', 'Application / On File with State Board'] , ['Application Supplement', 'Application Supplement'], ['AuraData', 'AuraData'], ['DegreeCheck.com', 'DegreeCheck.com'], ['ECFMG', 'ECFMG'], ['NATIONAL STUDENT CLEARINGHOUSE', 'NATIONAL STUDENT CLEARINGHOUSE'] , ['NOT VERIFIED', 'NOT VERIFIED'] , ['School', 'School'] , ['State License Board', 'State License Board'] , ['Unable to Verify', 'Unable to Verify'] , ['Unable to Verify: Three Attempts Made', 'Unable to Verify: Three Attempts Made']], selected: @last_rva_information&.source_name.present? ? @last_rva_information&.source_name : ''), { include_blank: 'Select option' }, class: 'form-select' %>
                                  </div>
                                </div>
                                <hr>
                                <div class="form-row row">
                                  <div class="col-md-6">
                                    <%= f.label :source_date, 'Source Date:' %>
                                  </div>
                                  <div class="col-md-6">  
                                    <%= f.date_field :source_date, required: true, class: "form-control", value: @last_rva_information&.source_date %>
                                  </div>
                                </div>
                                <hr>
                                <div class="form-row row">
                                  <div class="col-md-6">
                                    <%= f.label :status, 'Status:' %>
                                  </div>
                                  <div class="col-md-6">
                                    <%= f.select :status, options_for_select([['Completed', 'Completed'], ['No Record Found', 'No Record Found'], ['Not Completed', 'Not Completed'], ['NOT VERIFIED', 'NOT VERIFIED'] , ['Unable to Verify', 'Unable to Verify'] , ['Unable to Verify: Three Attempts Made', 'Unable to Verify: Three Attempts Made'] ,['x', 'x']], @last_rva_information&.status), { include_blank: 'Select option' }, class: 'form-select' %>
                                  </div>
                                </div>
                                <hr>
                                <div class="card">
                                  <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <h6 class="form-heading">Adverse Action</h6>
                                    </div>    
                                    <div class="form-row d-flex align-items-center gap-3 mt-1">
																		 <%= f.select :adverse_action, options_for_select([
                                        ['None', 'None'],
                                        ['Actions in Process at Time of Termination', 'Actions in Process at Time of Termination'],
                                        ['Did Not Complete in Good Standing', 'Did Not Complete in Good Standing'],
                                        ['Discrepancy', 'Discrepancy'],
                                        ['Do Not Recommend', 'Do Not Recommend'],
                                        ['Emotional Limitation', 'Emotional Limitation'],
                                        ['Mental Limitation', 'Mental Limitation'],
                                        ['No Record Found', 'No Record Found'],
                                        ['Other', 'Other'],
                                        ['Other Disciplinary Action', 'Other Disciplinary Action'],
                                        ['Physical Limitation', 'Physical Limitation'],
                                        ['Prefer Not to Comment', 'Prefer Not to Comment'],
                                        ['Recommend with Some Reservation', 'Recommend with Some Reservation'],
                                        ['Reprimand', 'Reprimand'],
                                        ['Suspension', 'Suspension'],
                                        ['Termination', 'Termination'],
                                        ['testlm', 'testlm'],
                                        ['Unable to verify', 'Unable to verify'],
                                        ['Voluntary Restriction of Privileges', 'Voluntary Restriction of Privileges'],
                                        ['Voluntary Termination to Avoid Action', 'Voluntary Termination to Avoid Action'],
                                        ['Would like WebCVO representative to contact me', 'Would like WebCVO representative to contact me']
                                      ],  @last_rva_information&.adverse_action), { include_blank: 'Select option' }, class: 'form-select' %>
                                      </div>
                                    <div class="form-row row">
                                      <div class="col-xl-6">
                                        <%= f.label :other_details, 'Other:' %>
                                        <%= f.text_area :other_details, rows: 5, class: 'form-control', value: @last_rva_information&.other_details  %>
                                      </div>
                                      <div class="col-xl-6">
                                        <%= f.label :adverse_action_comments, 'Comments:' %>
                                        <%= f.text_area :adverse_action_comments, rows: 5, class: 'form-control', value: @last_rva_information&.adverse_action_comments  %>
                                      </div>
                                    </div>
                                    <div class="form-row d-flex align-items-center gap-2 mt-1">
                                    <%= f.radio_button :adverse_action_status, 'Open', 
                                                        id: 'verif-open', 
                                                        checked: @last_rva_information&.adverse_action_status == 'Open' %>
                                    <%= f.label :adverse_action_status, 'Open', for: 'verif-open' %>

                                    <%= f.radio_button :adverse_action_status, 'Close', 
                                                        id: 'verif-close', 
                                                        checked: @last_rva_information&.adverse_action_status == 'Close' %>
                                    <%= f.label :adverse_action_status, 'Close', for: 'verif-close' %>
                                  </div>

                                  <div class="form-row d-flex align-items-center gap-2">
                                    <%= f.label :in_good_standing, 'In Good Standing?' %>

                                    <%= f.radio_button :in_good_standing, 'Yes', 
                                                        id: 'good-standing-yes', 
                                                        checked: @last_rva_information&.in_good_standing == true %>
                                    <%= f.label :in_good_standing, 'Yes', 
                                                for: 'good-standing-yes', 
                                                class: 'form-check-label' %>

                                    <%= f.radio_button :in_good_standing, 'No', 
                                                        id: 'good-standing-no', 
                                                        checked: @last_rva_information&.in_good_standing == false %>
                                    <%= f.label :in_good_standing, 'No', 
                                                for: 'good-standing-no', 
                                                class: 'form-check-label' %>
                                  </div>
                                </div>
                                <!-- Verification Errors Section -->
                                <div class="form-row row mt-3">
                                  <div class="col-xl-12">
                                    <div class="card other-name-card">
                                      <div class="card-body">
                                        <h6 class="form-heading">Verification Errors</h6>
                                        <div class="form-row row">
                                          <div class="col-xl-6">
                                            <%= f.label :error_type, 'Error:' %>
                                            <%= f.select :error_type, options_for_select([['None', 'None'] , ['Degree/Certificate Received', 'Degree/Certificate Received'], ['Detailed Attestation Explanation Missing', 'Detailed Attestation Explanation Missing'], ['Detailed Explanation for Failure to Complete Program Missing', 'Detailed Explanation for Failure to Complete Program Missing'], ['From Date', 'From Date'], ['Incorrect Attestation Response', 'Incorrect Attestation Response'], ['No Record Found', 'No Record Found'], ['Other', 'Other'], ['Other Degree/Certificate', 'Other Degree/Certificate'], ['Program Completion', 'Program Completion'], ['Program Title', 'Program Title'], ['Record too Old', 'Record too Old'], ['School Name', 'School Name'], ['To Date', 'To Date']], @last_rva_information&.error_type || 'None'), { include_blank: 'Select option' }, class: 'form-select' %>

                                          </div>
                                          <div class="col-xl-6">
                                            <%= f.label :error_comments, 'Comments:' %>
                                            <%= f.text_area :error_comments, rows: 3, class: 'form-control', value: @last_rva_information&.error_comments %>
                                          </div>
                                        </div>
                                        <div class="d-flex align-items-center justify-content-between mt-3">
                                          <button type="button" class="btn btn-primary py-1">Add Another Error</button>
                                          <button type="button" class="btn btn-danger">Remove</button>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                <!-- Correct Information Section -->
                                <div class="form-row row mt-3">
                                  <div class="col-xl-12">
                                    <div class="card other-name-card">
                                      <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-center">
                                          <h6 class="form-heading">Correct Information</h6>
                                          <div class="d-flex gap-2">
                                            <button class="btn btn-primary py-1">Verified</button>
                                            <button class="btn btn-primary py-1">Verify and Update with Correct Information</button>
                                          </div>
                                        </div>
                                        <div class="form-row row mt-3">
                                          <div class="col-xl-6">
                                            <%= f.label :correct_info_selected, 'Select Correct Info:' %>
                                            <%= f.select :correct_info_selected, options_for_select([['Degree/Certificate Received', 'Degree/Certificate Received'] , ['Detailed Attestation Explanation Missing', 'Detailed Attestation Explanation Missing'], ['Detailed Explanation for Failure to Complete Program Missing', 'Detailed Explanation for Failure to Complete Program Missing'], ['From Date', 'From Date'], ['Incorrect Attestation Response', 'Incorrect Attestation Response'], ['No Record Found', 'No Record Found'], ['Other Degree/Certificate', 'Other Degree/Certificate'], ['Program Completion', 'Program Completion'], ['Program Title', 'Program Title'], ['Record too Old', 'Record too Old'], ['School Name', 'School Name'], ['To Date', 'To Date']],  @last_rva_information&.correct_info_selected), { include_blank: 'Select option' }, class: 'form-select' %>
                                          </div>
                                          <div class="col-xl-6">
                                            <%= f.label :correct_info_text, 'Enter Details:' %>
                                            <%= f.text_field :correct_info_text, class: 'form-control', value: @last_rva_information&.correct_info_text %>
                                          </div>
                                        </div>
                                        <div class="d-flex align-items-center justify-content-between mt-3">
                                          <button type="button" class="btn btn-primary py-1">Add</button>
                                          <button type="button" class="btn btn-danger">Remove</button>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                <hr class="form-hr">
                                <div class="row mt-5">
                                  <div class="col-md-6">
                                    <label for="">Verification Status:</label>
                                  </div>
                                  <div class="col-md-6">
                                    <span class="font-bold verification-status"><%= @last_rva_information&.verification_status.presence || '' %></span>
                                  </div>
                                </div>
                                <hr class="form-hr">
                                <div class="row">
                                  <div class="col-md-6">
                                    <label for="">Notification Status:</label>
                                  </div>
                                  <div class="col-md-6">
                                    <span class="font-bold notification-status"><%= @last_rva_information&.notification_status.presence || '' %></span>
                                  </div>
                                </div>
                                <hr class="form-hr">
                                <div class="row">
                                  <div class="col-md-6">
                                    <label for="">Verification Date:</label>
                                  </div>
                                  <div class="col-md-6">
                                    <span class="font-bold verification-date"><%= @last_rva_information&.verification_date.presence || '' %></span>
                                  </div>
                                </div>
                                <hr class="form-hr">
                                <div class="row">
                                  <div class="col-md-6">
                                    <label for="">Verifier:</label>
                                  </div>
                                  <div class="col-md-6">
                                    <span class="font-bold verifier"><%= @last_rva_information&.verifier.presence || '' %></span>
                                  </div>
                                </div>
                                <hr class="form-hr">

                                <!-- Comments and Save Button -->
                                <div class="form-row row mt-3">
                                  <div class="col-xl-12">
                                    <%= f.label :verification_comments, 'Comments:' %>
                                    <%= f.text_area :verification_comments, rows: 3, class: 'form-control', value: @last_rva_information&.verification_comments %>
                                  </div>
                                </div>
                                <div class="d-flex justify-content-end gap-2 mt-3">
                                  <%= f.button 'Save Verification', class: 'btn btn-primary py-1', id: 'verification-btn' %>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="form-row row mt-3">
                          <div class="card other-name-card">
                            <div class="card-body">
                              <h6 class="form-heading">Audit</h6>

                              <div class="form-row row mt-3">
                                <div class="col-xl-12">
                                  <div class="card other-name-card">
                                    <div class="card-body">
                                      <h6 class="form-heading">Reasons</h6>
                                      <div class="form-row row">
                                        <div class="col-xl-6">
                                          <%= f.label :audit_reason, 'Reason:' %>
																					<%= f.select :audit_reason, options_for_select([ ['None', 'None'] , ['Adverse Action Not Recorded', 'Adverse Action Not Recorded'] , ['Completed Status Incorrect', 'Completed Status Incorrect'] , ['Degree/Certificate Received Incorrect', 'Degree/Certificate Received Incorrect'] , ['From Date Incorrect', 'From Date Incorrect'] , ['Not Completed Explanation Missing/Inadequate', 'Not Completed Explanation Missing/Inadequate'] , ['Program Title Incorrect', 'Program Title Incorrect'] ,['Schoolname Incorrect', 'Schoolname Incorrect'], ['Show on Tickler Status Incorrect', 'Show on Tickler Status Incorrect'], ['Source Date Incorrect', 'Source Date Incorrect'], ['Source Name Incorrect', 'Source Name Incorrect'], ['Theorem: Incorrect Information Entered', 'Theorem: Incorrect Information Entered'], ['Theorem: Necessary Information Not Entered', 'Theorem: Necessary Information Not Entered'], ['Theorem: Unnecessary Information Entered', 'Theorem: Unnecessary Information Entered'],['To Date Incorrect', 'To Date Incorrect'] , ['Verification Not Uploaded', 'Verification Not Uploaded'], ['Verification Status Incorrect', 'Verification Status Incorrect']],  @last_rva_information&.audit_reason), { include_blank: 'Select option' }, class: 'form-select' %>   
                                        </div>
                                        <div class="col-xl-6">
                                          <%= f.label :audit_reason_comments, 'Comments:' %>
                                          <%= f.text_field :audit_reason_comments, class: 'form-control', value: @last_rva_information&.audit_reason_comments %>
                                        </div>
                                      </div>
                                      <div class="d-flex align-items-center justify-content-between mt-3">
                                        <%= button_tag 'Add Another Reason', class: 'btn btn-primary py-1', type: 'button' %>
                                        <%= button_tag 'Remove', class: 'btn btn-danger', type: 'button' %>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>

                              <div class="form-row d-flex align-items-center gap-3">
                                <%= f.label :audit_status, 'Audit Status:' %>

                                <%= f.radio_button :audit_status, 'Pass', 
                                                    id: 'audit-status-pass', 
                                                    class: 'form-check-input', 
                                                    required: true, 
                                                    checked: @last_rva_information&.audit_status == true %>
                                <%= f.label :audit_status, 'Pass', 
                                             for: 'audit-status-pass', 
                                             class: 'form-check-label' %>

                                <%= f.radio_button :audit_status, 'Fail', 
                                                    id: 'audit-status-fail', 
                                                    class: 'form-check-input', 
                                                    required: true, 
                                                    checked: @last_rva_information&.audit_status == false %>
                                <%= f.label :audit_status, 'Fail', 
                                             for: 'audit-status-fail', 
                                             class: 'form-check-label' %>
                              </div>

                              <hr class="form-hr">

                              <div class="row">
                                <div class="col-md-6">
                                  <label for="">Audit Date:</label>
                                </div>
                                <div class="col-md-6">
                                  <span class="font-bold" id="rva_information_audit_date"><%= @last_rva_information&.audit_date.presence || '' %></span>
                                </div>
                              </div>
                              <hr class="form-hr">

                              <div class="row">
                                <div class="col-md-6">
                                  <label for="">Auditor:</label>
                                </div>
                                <div class="col-md-6">
                                  <span class="font-bold" id="rva_information_auditor"><%= @last_rva_information&.auditor.presence || '' %></span>
                                </div>
                              </div>
                              <hr class="form-hr">

                              <div class="form-row row">
                                <div class="col-xl-12">
                                  <%= f.label :audit_comments, 'Comments:' %>
                                  <%= f.text_area :audit_comments, rows: 3, class: 'form-control', value: @last_rva_information&.audit_comments %>
                                </div>
                              </div>

                              <div class="d-flex justify-content-end gap-2 mt-3">
                                <%= f.button 'Save Audit', class: 'btn btn-primary py-1', id: 'audit-btn' %>
                              </div>
                            </div>
                          </div>
                        </div>
                      <% end %>  
                    </div>
                  </div>
                </div>
              </div>
            </div>

<div class="modal fade" id="send_contact_template" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered">
        <div class="modal-content">
            <div class="p-4">
                <h2 class="text-center">Send Contact</h3>
                <div class="card other-name-card">
                    <div class="card-body">
                        <div class="col-xl-12 py-2">
                            <form accept-charset="UTF-8" action=<%= mhc_verification_platform_send_contact_path %> method="POST" enctype="multipart/form-data" target="_blank" id="ajaxForm">
                            <%# <form id='send_contact_form'> %>
                                <div class="row p-2">
                                    <div class="col-2 m-auto">
                                        Practitioner Name:
                                    </div>
                                    <div class="col-10">
                                        <input type="text" name="practitioner_name" value="<%= @provider_personal_information.fullname %>" class="form-control border-none" style="border: none!important" placeholder="Type here..." disabled>
                                    </div>
                                </div>
                                <div class="row p-2">
                                    <div class="col-2 m-auto">
                                        Select Contact To:
                                    </div>
                                    <div class="col-10">
                                        <select id="provider_type" name="provider_type" class="form-select">
                                            <option value="credentialing_contact" selected>Credentialing Contact</option>
                                            <option value="confidential_contact">Confidential Contact</option>
                                            <option value="client_contact">Client Contact</option>
                                            <% if @practice_information_education.persisted? %>
                                                <option value="intitution_contact"><%= @practice_information_education.institution_name%></option>
                                            <% end %>
                                        </select>
                                    </div>
                                </div>
                                <div class="row p-2">
                                    <div class="col-2 m-auto">
                                        Contact Method:
                                    </div>
                                    <div class="col-10 row">
                                        <div class="col-4 form-check d-flex align-items-center gap-2">
                                            <input class="form-check-input contact_method_radio" type="radio" name="contact_method_radio" id="contact-method-email" value="email" checked>
                                            <label class="form-check-label" for="contact-method-email">
                                                Email
                                            </label>
                                        </div>
                                        <div class="col-4 form-check d-flex align-items-center gap-2">
                                            <input class="form-check-input contact_method_radio" type="radio" name="contact_method_radio" id="contact-method-fax" value="fax" disabled>
                                            <label class="form-check-label" for="contact-method-fax">
                                                Fax
                                            </label>
                                        </div>
                                        <div class="col-4 form-check d-flex align-items-center gap-2">
                                            <input class="form-check-input contact_method_radio" type="radio" name="contact_method_radio" id="contact-method-letter" value="letter" disabled>
                                            <label class="form-check-label" for="contact-method-letter">
                                                Letter
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <div class="row p-2">
                                    <div class="col-2 m-auto">
                                        To:
                                    </div>
                                    <div class="col-10">
                                        <input type="text" id="to" name="to" class="form-control" placeholder="Type here..." required="true" value=<%= @provider_personal_information.provider_personal_information_credentialing_contact&.email%>>
                                    </div>
                                    <input type="hidden" id="cred_contact_email" value=<%= @provider_personal_information.provider_personal_information_credentialing_contact&.email %>>
                                    <input type="hidden" id="conf_contact_email" value=<%= @provider_personal_information.provider_personal_information_confidential_contact&.email %>>
                                    <input type="hidden" id="client_contact_email" value="">
                                    <input type="hidden" id="intitution_contact_email" value=<%= @practice_information_education.email_address %>>

                                </div>
                                <div class="row p-2">
                                    <div class="col-2 m-auto">
                                        Subject:
                                    </div>
                                    <div class="col-10">
                                        <input type="text" name="subject" class="form-control" placeholder="Type here..." required="true">
                                    </div>
                                </div>
                                <div class="row p-2">
                                    <div class="col-2 m-auto">
                                        Attachments:
                                    </div>
                                    <div class="col-10">
                                        <input type="file" name="attachments[]" multiple="multiple" class="form-control" placeholder="Type here..." required="true">
                                    </div>
                                </div>
                                <textarea class="form-control" name="message" placeholder="Type here..." rows="8" required="true"></textarea>
                            </form>
                        </div>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary btn-md w-100" form="ajaxForm">
                    <strong>Send</strong>
                </button>
                <button class="btn btn-cancel w-100" data-bs-dismiss="modal" id="btn-modal-close-send-contact">Cancel</button>
            </div>
        </div>
    </div>
</div>


<script type="text/javascript">
  $(document).ready(function() {
      var csrfToken = $('meta[name="csrf-token"]').attr('content');
      $('.contact_method_radio').on('change',function(e) {
          if($(this).val() == 'email') {
              var provider_type = $('#provider_type').val()
              console.log("provider_type")
              if(provider_type == 'credentialing_contact') {
                  $('#to').val($('#cred_contact_email').val())
              }
              if(provider_type == 'confidential_contact') {
                  $('#to').val($('#conf_contact_email').val())
              }
              if(provider_type == 'client_contact') {
                  $('#to').val($('#client_contact_email').val())
              }
              if(provider_type == 'intitution_contact') {
                  $('#to').val($('#intitution_contact_email').val())
              }
          }
      });

      $('#provider_type').on('change',function(e) {
          if($(this).val() == 'credentialing_contact') {
              $('#to').val($('#cred_contact_email').val())
          }
          if($(this).val() == 'confidential_contact') {
              $('#to').val($('#conf_contact_email').val())
          }
          if($(this).val() == 'client_contact') {
              $('#to').val($('#client_contact_email').val())
          }
          if($(this).val() == 'intitution_contact') {
              $('#to').val($('#intitution_contact_email').val())
          }
      });

      VirtualSelect.init({
          options: {},
          ele: '#result_school_list',
          search: true,
          showSelectedOptionsFirst: true
      });

      $("#ajaxForm").submit(function(e){
          e.preventDefault();
          var action = $(this).attr("action");
          var formData = new FormData(this)
          formData.append('authenticity_token', csrfToken);
          $.ajax({
              type: "POST",
              url: action,
              crossDomain: true,
              data: formData,
              dataType: "json",
              contentType: "multipart/form-data",
              processData: false,
              contentType: false,
              headers: {
                  "Accept": "application/json"
              }
          }).done(function() {
              $('#btn-modal-close-send-contact').trigger('click');
              $('#ajaxForm').trigger("reset");
              $('.loading-overlay').hide();
          }).fail(function() {
              alert('An error occurred.')
              $('.loading-overlay').hide();
          });
      });

      $("#confirm_school_button").on('click', function(e) {
          e.preventDefault();
          $("#practice_information_education_institution_name").val($("#search_school_name").val())
          $("#practice_information_education_address").val($("#search_school_address").val())
          $("#practice_information_education_suite").val($("#search_school_suite").val())
          $("#practice_information_education_address2").val($("#search_school_address2").val())
          $("#practice_information_education_city").val($("#search_school_city").val())
          $("#practice_information_education_county").val($("#search_school_county").val())
          $("#practice_information_education_state").val($("#search_school_state").val())
          $("#practice_information_education_postal_code").val($("#search_school_postal_code").val())
          $("#practice_information_education_country").val($("#search_school_country").val())
          $("#practice_information_education_phone_number").val($("#search_school_phone").val())
          $("#practice_information_education_fax_number").val($("#search_school_fax").val())
          $("#practice_information_education_email_address").val($("#search_school_email").val())
          $('#btn-modal-close').trigger('click');
      });

      $("#search_school_form").submit(function(e){
          e.preventDefault();
          var action = $(this).attr("action");
          $.ajax({
              type: "POST",
              url: action,
              crossDomain: true,
              data: { authenticity_token: csrfToken, q: {
                  name_cont: $("#search_school_form_name_cont").val(),
                  state_eq:  $("#search_school_form_state").val()
              } },
              dataType: "json",
          }).success(function(data) {
              schools = data['schools']
              document.querySelector('#result_school_list').setOptions(schools);
              $('.loading-overlay').hide();
          }).fail(function() {
              alert('An error occurred.')
              $('.loading-overlay').hide();
          });
      });

      $('#result_school_list').on('change', function(e) {
          if($('#result_school_list').val() != "") {
              school_id = $('#result_school_list').val()
              $.ajax({
                  type: "GET",
                  url: "/mhc/schools/" + school_id + ".json",
                  crossDomain: true,
                  dataType: "json",
              }).success(function(data) {
                  console.log(data)
                  $("#search_school_name").val(data["school"]["name"])
                  $("#search_school_address").val(data["school"]["address"])
                  $("#search_school_suite").val(data["school"]["suite"])
                  $("#search_school_address2").val(data["school"]["address2"])
                  $("#search_school_city").val(data["school"]["city"])
                  $("#search_school_county").val(data["school"]["county"])
                  $("#search_school_state").val(data["school"]["state"])
                  $("#search_school_postal_code").val(data["school"]["postal_code"])
                  $("#search_school_country").val(data["school"]["country"])
                  $("#search_school_contact_method").val(data["school"]["contact_method"])
                  $("#search_school_phone").val(data["school"]["phone"])
                  $("#search_school_fax").val(data["school"]["fax"])
                  $("#search_school_email").val(data["school"]["email"])
                  $('.loading-overlay').hide();

              }).fail(function() {
                  alert('An error occurred.')
                  $('.loading-overlay').hide();
              });
          }
      })

      $('#add_school').on('shown.bs.modal', function () {
          $.ajax({
              url: '<%= get_states_path %>',
              method: 'GET',
              data: { authenticity_token: csrfToken },
              success: function(data) {
                  states = data['states']
                  VirtualSelect.init({
                      options: states,
                      ele: '#add_school_state',
                      search: true,
                      showSelectedOptionsFirst: true
                  });
              }
          })
      })

      $('#search_school').on('shown.bs.modal', function () {
          $.ajax({
              url: '<%= get_states_path %>',
              method: 'GET',
              data: { authenticity_token: csrfToken },
              success: function(data) {
                  states = data['states']
                  VirtualSelect.init({
                      options: states,
                      ele: '#search_school_form_state',
                      search: true,
                      showSelectedOptionsFirst: true
                  });
              }
          })
      })

      $("#add_school_form").submit(function(e){
          e.preventDefault();
          var action = $(this).attr("action");
          var school = {
              name: $("#add_school_name").val(),
              address: $("#add_school_address").val(),
              suite: $("#add_school_suite").val(),
              address2: $("#add_school_address2").val(),
              city: $("#add_school_city").val(),
              county: $("#add_school_county").val(),
              state: $("#add_school_state").val(),
              postal_code: $("#add_school_postal_code").val(),
              country: $("#add_school_country").val(),
              contact_method: $("#add_school_contact_method").val(),
              phone: $("#add_school_phone").val(),
              fax: $("#add_school_fax").val(),
              email: $("#add_school_email").val(),
          }
          $.ajax({
              type: "POST",
              url: action,
              crossDomain: true,
              data: { authenticity_token: csrfToken, school: school },
              dataType: "json",
          }).success(function(data) {
              console.log(data["school"])
              $('#btn-modal-close').trigger('click');
              $('#search_school_button').trigger('click');
              $("#search_school_name").val(data["school"]["name"])
              $("#search_school_address").val(data["school"]["address"])
              $("#search_school_suite").val(data["school"]["suite"])
              $("#search_school_address2").val(data["school"]["address2"])
              $("#search_school_city").val(data["school"]["city"])
              $("#search_school_county").val(data["school"]["county"])
              $("#search_school_state").val(data["school"]["state"])
              $("#search_school_postal_code").val(data["school"]["postal_code"])
              $("#search_school_country").val(data["school"]["country"])
              $("#search_school_contact_method").val(data["school"]["contact_method"])
              $("#search_school_phone").val(data["school"]["phone"])
              $("#search_school_fax").val(data["school"]["fax"])
              $("#search_school_email").val(data["school"]["email"])
              $('.loading-overlay').hide();
          }).fail(function() {
              alert('An error occurred.')
              $('.loading-overlay').hide();
          });
      });
  })

  var csrfToken = $('meta[name="csrf-token"]').attr('content');

  $("#ajaxForm").submit(function(e){
      e.preventDefault();
      var action = $(this).attr("action");
      var formData = new FormData(this)
      formData.append('authenticity_token', csrfToken);
      $.ajax({
          type: "POST",
          url: action,
          crossDomain: true,
          data: formData,
          dataType: "json",
          contentType: "multipart/form-data",
          processData: false,
          contentType: false,
          headers: {
              "Accept": "application/json"
          }
      }).done(function() {
          $('#btn-modal-close').trigger('click');
          $('.loading-overlay').hide();
      }).fail(function() {
          alert('An error occurred.')
          $('.loading-overlay').hide();
      });
  });

  <%# rva_information section js %>
  document.addEventListener('DOMContentLoaded', function () {
    // Send request parameter
    document.getElementById('send-request-btn').addEventListener('click', function (e) {
      e.preventDefault();
      const firstName = document.getElementById('firstname').innerText.trim();
      const personalInfoId = document.querySelector('input[name="personal_info_id"]').value;
      const practiceInfoEducationId = document.querySelector('input[name="practice_info_education_id"]').value;

      document.querySelector('.loading-overlay').style.display = 'block';

      fetch('/webscrapers/send_education_request', {
        method: 'POST',
        headers: {
          'X-CSRF-Token': document.querySelector('meta[name="csrf-token"]').content,
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          first_name: firstName,
          personal_info_id: personalInfoId,
          practice_education_id: practiceInfoEducationId
        })
      })
        .then(response => response.json())
        .then(data => {
          populateRvaData(data.rva_information);
          document.querySelector('.loading-overlay').style.display = 'none';
          document.getElementById('send-request-btn').setAttribute('disabled', 'true');
          document.getElementById('send-request-btn').classList.remove('btn');
        })
        .catch(error => console.error('Error:', error));
    });

    // Verification Button Click
    document.getElementById('verification-btn').addEventListener('click', function (e) {
      e.preventDefault();
      if (!document.getElementById('rva_information_source_date').value) {
        alert('Please select a Source Date before saving.');
        return;
      }

      const auditFormData = new FormData(document.getElementById('audit-form'));
      auditFormData.append('section', 'verification');

      fetch('/mhc/verification-platform/generate_rva_information', {
        method: 'POST',
        headers: {
          'X-CSRF-Token': document.querySelector('meta[name="csrf-token"]').content
        },
        body: auditFormData
      })
        .then(response => response.json())
        .then(data => {
          populateRvaData(data.rva_information);
        })
        .catch(error => console.error('Error:', error));
    });

    // Audit Button Click
    document.getElementById('audit-btn').addEventListener('click', function (e) {
      e.preventDefault();
      if (!document.querySelector('input[name="rva_information[audit_status]"]:checked')) {
        alert('Please select an Audit Status before saving.');
        return;
      }

      const auditFormData = new FormData(document.getElementById('audit-form'));
      auditFormData.append('section', 'audit');
      auditFormData.append('practice_info_education_id', document.querySelector('input[name="practice_info_education_id"]').value);

      fetch('/mhc/verification-platform/generate_rva_information', {
        method: 'POST',
        headers: {
          'X-CSRF-Token': document.querySelector('meta[name="csrf-token"]').content
        },
        body: auditFormData
      })
        .then(response => response.json())
        .then(data => {
          populateRvaData(data.rva_information);
          document.getElementById('re-rva').classList.remove('d-none');
        })
        .catch(error => console.error('Error:', error));
    });

    // Skip RVA Button Click
    if (!document.getElementById('skip-rva-btn').dataset.listenerAttached) {
      document.getElementById('skip-rva-btn').dataset.listenerAttached = 'true';

      document.getElementById('skip-rva-btn').addEventListener('click', function (e) {
        e.preventDefault(); // Prevent default to avoid double submit
        const button = e.target;
        const informationId = button.dataset.informationId;
        const personalInformationId = button.dataset.personalInformationId;
        const educationId = button.dataset.educationId;

        document.querySelector('.loading-overlay').style.display = 'block';

        fetch('/webscrapers/send_education_skip_rva', {
          method: 'POST',
          headers: {
            'X-CSRF-Token': document.querySelector('meta[name="csrf-token"]').content,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            information_id: informationId,
            personal_information_id: personalInformationId,
            education_id: educationId,
          }),
        })
          .then(response => response.json())
          .then(data => {
            if (data.success) {
              populateRvaData(data.rva_information);
              document.querySelector('.loading-overlay').style.display = 'none';
              const modal = new bootstrap.Modal(document.getElementById('QAModal'));
              modal.show();
            } else {
              alert('Failed to create RVA record');
            }
          })
          .catch(error => {
            console.error('Error:', error);
            document.querySelector('.loading-overlay').style.display = 'none';
          });
      });
    }

    // Show Modal Event Listener
    const qualityAuditModal = document.getElementById('QAModal');
    qualityAuditModal.addEventListener('show.bs.modal', function (event) {
      const button = event.relatedTarget;
      document.querySelector('[name="first_name"]').value = button.dataset.firstName || '';
      document.querySelector('[name="last_name"]').value = button.dataset.lastName || '';
      document.querySelector('[name="id"]').value = button.dataset.informationId || '';
      document.querySelector('[name="personal_info_id"]').value = button.dataset.personalInformationId || '';
      document.querySelector('[name="practice_info_education_id"]').value = button.dataset.educationId || '';
    });
  });

  function populateRvaData(rvaInfo) {
    if (!rvaInfo) return;

    const setElementValue = (selector, value) => {
      const element = document.querySelector(selector);
      if (element) element.value = value || '';
    };

    const setElementText = (selector, value) => {
      const element = document.querySelector(selector);
      if (element) element.innerText = value || '';
    };

    const setElementChecked = (selector, value) => {
      const element = document.querySelector(selector);
      if (element) element.checked = !!value;
    };

    // Populate General Data
    setElementValue('[name="id"]', rvaInfo.id);
    setElementText('.sent-request', rvaInfo.send_request);
    setElementText('.requested-by', rvaInfo.requested_by);
    setElementText('.requested-date', rvaInfo.requested_date);
    setElementValue('.req-fee-amount', rvaInfo.required_fee_amount);
    setElementText('.received-by', rvaInfo.received_by);
    setElementText('.received-date', rvaInfo.received_date);
    setElementValue('.request-comment', rvaInfo.comments);
    setElementChecked('input[name="check_generated"]', rvaInfo.required_fee_amount);
    setElementChecked('input[name="received_status"]', rvaInfo.received_status);

    // Check requested method dynamically
    if (rvaInfo.requested_method) {
      const methodElement = document.getElementById(`method-${rvaInfo.requested_method}`);
      if (methodElement) methodElement.checked = true;
    }

    // Verification Section
    setElementText('.verification-status', rvaInfo.verification_status);
    setElementText('.verification-date', rvaInfo.verification_date);
    setElementText('.verifier', rvaInfo.verifier);
    setElementValue('#rva_information_verification_comments', rvaInfo.verification_comments);
    setElementChecked('input[name="rva_information[in_good_standing]"]', rvaInfo.in_good_standing);

    // Audit Section
    setElementValue('input[name="rva_information[audit_status]"]', rvaInfo.audit_status);
    setElementText('#rva_information_audit_date', rvaInfo.audit_date);
    setElementText('#rva_information_auditor', rvaInfo.auditor);
    setElementValue('#rva_information_audit_comments', rvaInfo.audit_comments);

    // Check audit status dynamically
    if (rvaInfo.audit_status === true) {
      const auditPass = document.getElementById('audit-status-pass');
      if (auditPass) auditPass.checked = true;
    } else {
      const auditFail = document.getElementById('audit-status-fail');
      if (auditFail) auditFail.checked = true;
    }

    // Handle adverse action dynamically
    if (rvaInfo.adverse_action_status !== undefined) {
      const adverseActionElement = document.getElementById(`verif-${rvaInfo.adverse_action_status}`);
      if (adverseActionElement) adverseActionElement.checked = true;
    }
  }
</script>


<style type="text/css">
  .multi-select, .search-select, .single-select {
    padding: 0;
      width: 100%;
      max-width: 1000px;
  }
  .single-select  {
    width: 100%;
    max-width: 1000px;
    padding: 0;
  }
</style>