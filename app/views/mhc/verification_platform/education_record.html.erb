
<div class="enc-content">
    <div class="container">
        <%= render "top_nav_buttons"%>
        <div class="mt-4">
            <div class="d-flex align-items-center gap-3">
                <a href="<%= mhc_verification_platform_path(page_tab: 'education')%>" class="link-back">
                    <i class='bx bx-left-arrow-alt'></i>
                </a>
                <h4 class="page-heading">Education Record</h4>
            </div>
        </div>
        <div class="row">
            <div class="col-xl-8 row">
                <%= form_with model: [:mhc, @practice_information_education] do |f| %>
                    <%= f.hidden_field :caqh_provider_attest_id %>
                    <%= f.hidden_field :provider_attest_id %>
                    <div class="form-row row page-applicable mt-3">
                        <span class="page-note">
                            <i class='bx bx-error-circle font-lightblue'></i> <span>To search for a School name,
                                please
                                click the search button.</span>
                        </span>
                        <div class="col-12">
                            <label class="text-dark-grey">School:</label>
                            <div class="row">
                                <div class="col-10">
                                    <%= f.text_field :institution_name,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                                </div>
                                <div class="col-2">
                                    <button id="search_school_button" type="button" class="btn btn-primary btn-sm" id="asdf" style="min-width: 100px; font-size: 12px" data-bs-toggle="modal" data-bs-target="#search_school">
                                        Search
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <label class="text-dark-grey">Address:</label>
                            <%= f.text_field :address,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-12">
                            <label class="text-dark-grey">Suite/Dept/Mail Stop:</label>
                            <%= f.text_field :suite_dept_mail_stop,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-12">
                            <label class="text-dark-grey">Additional Address:</label>
                            <%= f.text_field :address2,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">City:</label>
                            <%= f.text_field :city,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">County:</label>
                            <%= f.text_field :county,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">Country:</label>
                            <%= f.text_field :country,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">Province:</label>
                            <%= f.text_field :province,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">State:</label>
                            <%= f.text_field :state,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">Postal Code:</label>
                            <%= f.text_field :postal_code,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">Email Address:</label>
                            <%= f.text_field :email_address,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">Phone Number:</label>
                            <%= f.text_field :phone_number,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">Fax Number:</label>
                            <%= f.text_field :fax_number,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">Program Title</label>
                            <%= f.text_field :program_title,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">Degree/Certificate Received:</label>
                            <%= f.text_field :degree_degree_abbreviation,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">If Other, please fill:</label>
                            <%= f.text_field :if_other_list,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">Start Date:</label>
                            <%= f.date_field :start_date, placeholder: 'Select a date...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-xl-6">
                            <label class="text-dark-grey">End Date:</label>
                            <%= f.date_field :end_date, placeholder: 'Select a date...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-12">
                            <div>
                                <%= f.label :program_completed_flag, "Completed?" %>
                                <%= f.check_box :program_completed_flag %>
                            </div>
                        </div>
                        <div class="col-12">
                            <label class="text-dark-grey">Incomplete Explanation:</label>
                            <%= f.text_field :incomplete_explanation,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div class="col-12">
                            <label class="text-dark-grey">Please list any comments:</label>
                            <%= f.text_field :comments,  placeholder: 'Type here...', class: 'form-control border border-dark' %>
                        </div>
                        <div>
                        <%= f.label :show_on_tickler, "Show On Tickler?" %>
                        <%= f.check_box :show_on_tickler, class: "form-check-input" %>
                        </div>
                        <div class="col-12 text-left" style="margin-top: 20px;">
                            <%= f.submit 'Save', class: 'btn btn-primary', style: 'width: 200px;' %>
                        </div>
                        <% if @practice_information_education.persisted? %>
                            <div class="col-12 text-left" style="margin-top: 10px;">
                                <%= button_to 'Delete', 
                                    mhc_practice_information_education_path(@practice_information_education, provider_attest_id: @practice_information_education.provider_attest_id), 
                                    method: :delete, 
                                    data: { confirm: 'Are you sure you want to delete this education detail?' }, 
                                    class: 'btn btn-danger', 
                                    style: 'width: 200px;' %>
                            </div>
                        <% end %>
                    </div>
                <% end %>
            </div>
            <% if @practice_information_education.persisted? %>
                <div class="col-xl-4 p-2 text-center">
                    <div class="row">
                        <div class="col-12 m-2">
                            <button class="btn btn-primary btn-sm" style="min-width: 100px; font-size: 12px" disabled>
                                Verification Letter
                            </button>
                        </div>
                        <div class="col-12 m-2">
                            <button  type="button" class="btn btn-primary btn-sm" id="asdf" style="min-width: 100px; font-size: 12px" data-bs-toggle="modal" data-bs-target="#send_contact_template">
                                Send Contact
                            </button>
                        </div>
                    </div>
                    <div class="card other-name-card">
                        <div class="card-body">
                            <h2 class="">RVA Information</h2>
                            <div class="mt-3 row">
                                <div class="col-12 m-2">
                                    <button class="btn btn-primary btn-sm" style="min-width: 100px; font-size: 12px" disabled>
                                        Request
                                    </button>
                                </div>
                                <div class="col-12 m-2">
                                    <button class="btn btn-primary btn-sm" style="min-width: 100px; font-size: 12px" disabled>
                                        Verification
                                    </button>
                                </div>
                                <div class="col-12 m-2">
                                    <button class="btn btn-primary btn-sm" style="min-width: 100px; font-size: 12px" disabled>
                                        Audit
                                    </button>
                                </div>
                                <div class="col-12 m-2">
                                    <button class="btn btn-primary btn-sm" style="min-width: 100px; font-size: 12px" disabled>
                                        Quality Audit
                                    </button>
                                </div>
                                <div class="col-12 m-2">
                                    <button class="btn btn-primary btn-sm" style="min-width: 100px; font-size: 12px" disabled>
                                        Skip RVA
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12 m-2">
                            <button class="btn btn-primary btn-sm" style="min-width: 100px; font-size: 12px" disabled>
                                View Scanned Images
                            </button>
                        </div>
                    </div>
                    <div class="card other-name-card">
                        <div class="card-body">
                            <h2 class="">Message Board</h2>
                            <div class="mt-3 row">
                                <div class="col-12 m-2">
                                    <ul style="list-style: none;overflow:scroll; height:400px;">
                                        <% if @provider_personal_information_comments.present? %>
                                            <% @provider_personal_information_comments.each do |comment| %>
                                                <li class="mt-2">
                                                <span class="btn bg-alt-grey py-1" 
                                                    data-bs-toggle="modal" 
                                                    data-bs-target="#deleteCommentModal" 
                                                    data-comment-id="<%= comment.id %>"
                                                    data-comment-subject= "<%= comment.subject %>"
                                                    data-comment-message= "<%= comment.message %>">
                                                    Subject : <%= comment.subject %>
                                                    <p><%= comment.user.first_name %> </p>
                                                </span>
                                                <span class="btn py-1">
                                                <%= button_to mhc_provider_personal_information_comment_path(comment.id), method: :delete, class: 'btn btn-danger' do %>
                                                    <i class="bx bx-trash"></i>
                                                <% end %>
                                                </span>
                                                </li>
                                            <% end %> 
                                        <% else %>
                                            <p class="btn bg-alt-grey py-1">No comment yet!</p>
                                        <% end %>
                                    </ul>
                                </div>
                                <div class="col-12 m-2">
                                    <button type="button" class="btn btn-primary btn-sm" style="min-width: 100px; font-size: 12px" data-bs-toggle="modal" data-bs-target="#addCommentModal">
                                        Add Comment
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            <% end %>
        </div>
    </div>
</div>

<!-- Add Comment Modal -->
<div class="modal fade" id="addCommentModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body">
                <div class="content">
                    <div class="modal-title">
                        <h6 class="offset-md-5">Add Comment</h6>
                        <button class="btn btn-cancel" data-bs-dismiss="modal">Cancel</button>
                    </div>
                    <%= form_with(model: @provider_personal_information_comment, url: mhc_provider_personal_information_comments_path, method: :post) do |f| %>

                        <%= f.hidden_field :provider_personal_information_id, value: @provider_personal_information.id %>
                        <%= f.hidden_field :page_tab, value: 'education_record' %>
                        <div class="form-row mt-3">
                        <label for="provider_personal_information_comment_subject">Subject:</label>
                        <%= f.text_field :subject, class: "form-control" %>
                        </div>

                        <div class="form-row">
                        <label for="provider_personal_information_comment_message">Message:</label>
                        <%= f.text_area :message, class: "form-control", rows: 5 %>
                        </div>

                        <div class="form-row mt-3 d-flex justify-content-center">
                        <%= f.submit 'Post Comment', class: 'btn btn-primary' %>
                        </div>
                    <% end %>


                    <%# <form action="">
                        <div class="form-row mt-3">
                            <label for="">Subject:</label>
                            <input type="text" class="form-control">
                        </div>
                        <div class="form-row">
                            <label for="">Message:</label>
                            <textarea name="" id="" cols="30" rows="5" class="form-control"></textarea>
                        </div>
                    </form>
                    <div class="form-row mt-3 d-flex justify-content-center">
                        <button class="btn btn-primary">Post Comment</button>
                    </div> %>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="search_school" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered">
        <div class="modal-content">
            <div class="p-4">
                <h2 class="text-center">Search For School</h3>
                <div class="card other-name-card">
                    <div class="card-body">
                        <span class="page-note">
                            <i class='bx bx-error-circle font-lightblue'></i> <span>
                            To search for an existing school, please select the Country, State or Province, City and School from the drop down lists. If your School is not on the list, click the New button. Complete the requested address information of the department or office that may verify your degree or certificate. Click the Save button. Click the Close button to populate the record with the new address information.</span>
                        </span>
                        <div class="col-xl-12">
                            <form accept-charset="UTF-8" action=<%= get_schools_url %> method="POST" id="search_school_form" class="form_search_with_icon m-3">
                                <div class="form-row row">
                                    <div class="col-12">
                                        <label for="state">State:</label>
                                        <div class="search-select form-control border border-dark" name="q[state_eq]" id="search_school_form_state">
                                        </div>
                                    </div>
                                    <div class="col-12">
                                        <label for="name">School:</label>
                                        <input type="text" class="form-control" id="search_school_form_name_cont" name="q[name_cont]" placeholder="Search Education record by name" aria-label="Search Education record" aria-describedby="basic-addon2">
                                    </div>
                                </div>
                                <div class="text-center mt-2">
                                    <button class="btn btn-primary" type="submit"  form="search_school_form">Search</button>
                                </div>
                            </form>

                            <div class="form-row row p-2 text-center m-auto">
                                <div class="col-12">
                                    <label for="state">Search Result School list:</label>
                                    <div class="search-select form-control border border-dark" name="result_school" id="result_school_list">
                                    </div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="m-2">
                                    <div class="form-row row">
                                        <div class="col-xl-6 ">
                                            <label for="name">School:</label>
                                            <input type="text" name="name" id="search_school_name" class="form-control form-control-lg"
                                                placeholder="Type here.." disabled="true">
                                        </div>
                                        <div class="col-xl-6">
                                            <label for="address">Address:</label>
                                            <input type="text" name="address" id="search_school_address" class="form-control form-control-lg"
                                                placeholder="Type here.." disabled="true">
                                        </div>
                                    </div>
                                    <div class="form-row row">
                                        <div class="col-xl-6">
                                            <label for="suite">Suite/Mail Stop:</label>
                                            <input type="text" name="suite" id="search_school_suite" class="form-control form-control-lg"
                                                placeholder="Type here.." disabled="true">
                                        </div>
                                        <div class="col-xl-6">
                                            <label for="address2">Additional Address:</label>
                                            <input type="text" name="address2" id="search_school_address2"
                                                class="form-control form-control-lg" placeholder="Type here.." disabled="true">
                                        </div>
                                    </div>
                                    <div class="form-row row">
                                        <div class="col-xl-6">
                                            <label for="city">City:</label>
                                            <input type="text" name="city" id="search_school_city" class="form-control form-control-lg"
                                                placeholder="Type here.." disabled="true">
                                        </div>
                                        <div class="col-xl-6">
                                            <label for="county">County:</label>
                                            <input type="text" name="county" id="search_school_county" class="form-control form-control-lg"
                                                placeholder="Type here.." disabled="true">
                                        </div>
                                    </div>
                                    <div class="form-row row">
                                        <div class="col-xl-4">
                                            <label for="state">State/Province:</label>
                                            <input type="text" name="state" id="search_school_state" class="form-control form-control-lg"
                                                placeholder="Type here.." disabled="true">
                                        </div>
                                        <div class="col-xl-4">
                                            <label for="postal_code">Zip/Postal Code:</label>
                                            <input type="text" name="postal_code" id="search_school_postal_code" class="form-control form-control-lg"
                                                placeholder="Type here.." disabled="true">
                                        </div>
                                        <div class="col-xl-4">
                                            <label for="country">Country:</label>
                                            <input type="text" name="country" id="search_school_country" class="form-control form-control-lg"
                                                placeholder="Type here.." disabled="true">
                                        </div>
                                    </div>
                                    <div class="form-row row">
                                        <div class="col-xl-4">
                                            <label for="phone">Phone Number:</label>
                                            <input type="text" name="phone" id="search_school_phone" class="form-control form-control-lg"
                                                placeholder="Type here.." disabled="true">
                                        </div>
                                        <div class="col-xl-4">
                                            <label for="email">Email Address:</label>
                                            <input type="text" name="email" id="search_school_email" class="form-control form-control-lg"
                                                placeholder="Type here.." disabled="true">
                                        </div>
                                        <div class="col-xl-4">
                                            <label for="fax">Fax Number:</label>
                                            <input type="text" name="fax" id="search_school_fax" class="form-control form-control-lg"
                                                placeholder="Type here.." disabled="true">
                                        </div>
                                    </div>
                                    <div class="form-row row">
                                        <div class="col-xl-4">
                                            <label for="fax">Contact Method:</label>
                                            <input type="text" name="contact_method" id="search_school_contact_method" class="form-control form-control-lg"
                                                placeholder="Type here.." disabled="true">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="text-center mt-2">
                            <button type="submit" id="confirm_school_button" class="btn btn-success">Confirm</button>
                        </div>
                    </div>
                </div>
                <div class="text-center mt-2">
                    <button type="button" class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#add_school">
                        New
                    </button>
                </div>
                <button class="btn btn-cancel w-100" data-bs-dismiss="modal" id="btn-modal-close">Cancel</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="add_school" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered">
        <div class="modal-content">
            <div class="p-4">
                <h2 class="text-center">Add New School</h3>
                <div class="card other-name-card">
                    <div class="card-body">
                        <div class="col-xl-12">
                            <div class="card">
                                <form accept-charset="UTF-8" action=<%= mhc_schools_url %> method="POST" id="add_school_form" class="form_search_with_icon">
                                    <div class="m-2">
                                        <div class="form-row row">
                                            <div class="col-xl-6 ">
                                                <label for="name">School:</label>
                                                <input type="text" name="name" id="add_school_name" class="form-control form-control-lg"
                                                    placeholder="Type here..">
                                            </div>
                                            <div class="col-xl-6">
                                                <label for="address">Address:</label>
                                                <input type="text" name="address" id="add_school_address" class="form-control form-control-lg"
                                                    placeholder="Type here..">
                                            </div>
                                        </div>
                                        <div class="form-row row">
                                            <div class="col-xl-6">
                                                <label for="suite">Suite/Mail Stop:</label>
                                                <input type="text" name="suite" id="add_school_suite" class="form-control form-control-lg"
                                                    placeholder="Type here..">
                                            </div>
                                            <div class="col-xl-6">
                                                <label for="address2">Additional Address:</label>
                                                <input type="text" name="address2" id="add_school_address2"
                                                    class="form-control form-control-lg" placeholder="Type here..">
                                            </div>
                                        </div>
                                        <div class="form-row row">
                                            <div class="col-xl-6">
                                                <label for="city">City:</label>
                                                <input type="text" name="city" id="add_school_city" class="form-control form-control-lg"
                                                    placeholder="Type here..">
                                            </div>
                                            <div class="col-xl-6">
                                                <label for="county">County:</label>
                                                <input type="text" name="county" id="add_school_county" class="form-control form-control-lg"
                                                    placeholder="Type here..">
                                            </div>
                                        </div>
                                        <div class="form-row row">
                                            <div class="col-xl-4">
                                                <label for="state">State/Province:</label>
                                                <div class="search-select form-control border border-dark" name="state" id="add_school_state">
                                                </div>
                                            </div>
                                            <div class="col-xl-4">
                                                <label for="postal_code">Zip/Postal Code:</label>
                                                <input type="text" name="postal_code" id="add_school_postal_code" class="form-control form-control-lg"
                                                    placeholder="Type here..">
                                            </div>
                                            <div class="col-xl-4">
                                                <label for="country">Country:</label>
                                                <input type="text" name="country" id="add_school_country" class="form-control form-control-lg"
                                                    placeholder="Type here..">
                                            </div>
                                        </div>
                                        <div class="form-row row">
                                            <div class="col-xl-4">
                                                <label for="phone">Phone Number:</label>
                                                <input type="text" name="phone" id="add_school_phone" class="form-control form-control-lg"
                                                    placeholder="Type here..">
                                            </div>
                                            <div class="col-xl-4">
                                                <label for="email">Email Address:</label>
                                                <input type="text" name="email" id="add_school_email" class="form-control form-control-lg"
                                                    placeholder="Type here..">
                                            </div>
                                            <div class="col-xl-4">
                                                <label for="fax">Fax Number:</label>
                                                <input type="text" name="fax" id="add_school_fax" class="form-control form-control-lg"
                                                    placeholder="Type here..">
                                            </div>
                                        </div>
                                        <div class="form-row row">
                                            <div class="col-xl-4">
                                                <label for="fax">Contact Method:</label>
                                                <select id="add_school_contact_method" name="contact_method" class="form-select">
                                                    <option value="email" selected>Email</option>
                                                    <option value="letter">Letter</option>
                                                    <option value="fax">Fax</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <button type="submit" class="btn btn-primary btn-md w-100">
                                        <strong>Save</strong>
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <button class="btn btn-cancel w-100" data-bs-dismiss="modal" id="btn-modal-close">Cancel</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="send_contact_template" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered">
        <div class="modal-content">
            <div class="p-4">
                <h2 class="text-center">Send Contact</h3>
                <div class="card other-name-card">
                    <div class="card-body">
                        <div class="col-xl-12 py-2">
                            <form accept-charset="UTF-8" action=<%= mhc_verification_platform_send_contact_path %> method="POST" enctype="multipart/form-data" target="_blank" id="ajaxForm">
                            <%# <form id='send_contact_form'> %>
                                <div class="row p-2">
                                    <div class="col-2 m-auto">
                                        Practitioner Name:
                                    </div>
                                    <div class="col-10">
                                        <input type="text" name="practitioner_name" value="<%= @provider_personal_information.fullname %>" class="form-control border-none" style="border: none!important" placeholder="Type here..." disabled>
                                    </div>
                                </div>
                                <div class="row p-2">
                                    <div class="col-2 m-auto">
                                        Select Contact To:
                                    </div>
                                    <div class="col-10">
                                        <select id="provider_type" name="provider_type" class="form-select">
                                            <option value="credentialing_contact" selected>Credentialing Contact</option>
                                            <option value="confidential_contact">Confidential Contact</option>
                                            <option value="client_contact">Client Contact</option>
                                            <% if @practice_information_education.persisted? %>
                                                <option value="intitution_contact"><%= @practice_information_education.institution_name%></option>
                                            <% end %>
                                        </select>
                                    </div>
                                </div>
                                <div class="row p-2">
                                    <div class="col-2 m-auto">
                                        Contact Method:
                                    </div>
                                    <div class="col-10 row">
                                        <div class="col-4 form-check d-flex align-items-center gap-2">
                                            <input class="form-check-input contact_method_radio" type="radio" name="contact_method_radio" id="contact-method-email" value="email" checked>
                                            <label class="form-check-label" for="contact-method-email">
                                                Email
                                            </label>
                                        </div>
                                        <div class="col-4 form-check d-flex align-items-center gap-2">
                                            <input class="form-check-input contact_method_radio" type="radio" name="contact_method_radio" id="contact-method-fax" value="fax" disabled>
                                            <label class="form-check-label" for="contact-method-fax">
                                                Fax
                                            </label>
                                        </div>
                                        <div class="col-4 form-check d-flex align-items-center gap-2">
                                            <input class="form-check-input contact_method_radio" type="radio" name="contact_method_radio" id="contact-method-letter" value="letter" disabled>
                                            <label class="form-check-label" for="contact-method-letter">
                                                Letter
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <div class="row p-2">
                                    <div class="col-2 m-auto">
                                        To:
                                    </div>
                                    <div class="col-10">
                                        <input type="text" id="to" name="to" class="form-control" placeholder="Type here..." required="true" value=<%= @provider_personal_information.provider_personal_information_credentialing_contact&.email%>>
                                    </div>
                                    <input type="hidden" id="cred_contact_email" value=<%= @provider_personal_information.provider_personal_information_credentialing_contact&.email %>>
                                    <input type="hidden" id="conf_contact_email" value=<%= @provider_personal_information.provider_personal_information_confidential_contact&.email %>>
                                    <input type="hidden" id="client_contact_email" value="">
                                    <input type="hidden" id="intitution_contact_email" value=<%= @practice_information_education.email_address %>>

                                </div>
                                <div class="row p-2">
                                    <div class="col-2 m-auto">
                                        Subject:
                                    </div>
                                    <div class="col-10">
                                        <input type="text" name="subject" class="form-control" placeholder="Type here..." required="true">
                                    </div>
                                </div>
                                <div class="row p-2">
                                    <div class="col-2 m-auto">
                                        Attachments:
                                    </div>
                                    <div class="col-10">
                                        <input type="file" name="attachments[]" multiple="multiple" class="form-control" placeholder="Type here..." required="true">
                                    </div>
                                </div>
                                <textarea class="form-control" name="message" placeholder="Type here..." rows="8" required="true"></textarea>
                            </form>
                        </div>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary btn-md w-100" form="ajaxForm">
                    <strong>Send</strong>
                </button>
                <button class="btn btn-cancel w-100" data-bs-dismiss="modal" id="btn-modal-close-send-contact">Cancel</button>
            </div>
        </div>
    </div>
</div>


<script type="text/javascript">
    $(document).ready(function() {
        var csrfToken = $('meta[name="csrf-token"]').attr('content');
        $('.contact_method_radio').on('change',function(e) {
            if($(this).val() == 'email') {
                var provider_type = $('#provider_type').val()
                console.log("provider_type")
                if(provider_type == 'credentialing_contact') {
                    $('#to').val($('#cred_contact_email').val())
                }
                if(provider_type == 'confidential_contact') {
                    $('#to').val($('#conf_contact_email').val())
                }
                if(provider_type == 'client_contact') {
                    $('#to').val($('#client_contact_email').val())
                }
                if(provider_type == 'intitution_contact') {
                    $('#to').val($('#intitution_contact_email').val())
                }
            }
        });

        $('#provider_type').on('change',function(e) {
            if($(this).val() == 'credentialing_contact') {
                $('#to').val($('#cred_contact_email').val())
            }
            if($(this).val() == 'confidential_contact') {
                $('#to').val($('#conf_contact_email').val())
            }
            if($(this).val() == 'client_contact') {
                $('#to').val($('#client_contact_email').val())
            }
            if($(this).val() == 'intitution_contact') {
                $('#to').val($('#intitution_contact_email').val())
            }
        });

        VirtualSelect.init({
            options: {},
            ele: '#result_school_list',
            search: true,
            showSelectedOptionsFirst: true
        });

        $("#ajaxForm").submit(function(e){
            e.preventDefault();
            var action = $(this).attr("action");
            var formData = new FormData(this)
            formData.append('authenticity_token', csrfToken);
            $.ajax({
                type: "POST",
                url: action,
                crossDomain: true,
                data: formData,
                dataType: "json",
                contentType: "multipart/form-data",
                processData: false,
                contentType: false,
                headers: {
                    "Accept": "application/json"
                }
            }).done(function() {
                $('#btn-modal-close-send-contact').trigger('click');
                $('#ajaxForm').trigger("reset");
                $('.loading-overlay').hide();
            }).fail(function() {
                alert('An error occurred.')
                $('.loading-overlay').hide();
            });
        });

        $("#confirm_school_button").on('click', function(e) {
            e.preventDefault();
            $("#practice_information_education_institution_name").val($("#search_school_name").val())
            $("#practice_information_education_address").val($("#search_school_address").val())
            $("#practice_information_education_suite").val($("#search_school_suite").val())
            $("#practice_information_education_address2").val($("#search_school_address2").val())
            $("#practice_information_education_city").val($("#search_school_city").val())
            $("#practice_information_education_county").val($("#search_school_county").val())
            $("#practice_information_education_state").val($("#search_school_state").val())
            $("#practice_information_education_postal_code").val($("#search_school_postal_code").val())
            $("#practice_information_education_country").val($("#search_school_country").val())
            $("#practice_information_education_phone_number").val($("#search_school_phone").val())
            $("#practice_information_education_fax_number").val($("#search_school_fax").val())
            $("#practice_information_education_email_address").val($("#search_school_email").val())
            $('#btn-modal-close').trigger('click');
        });

        $("#search_school_form").submit(function(e){
            e.preventDefault();
            var action = $(this).attr("action");
            $.ajax({
                type: "POST",
                url: action,
                crossDomain: true,
                data: { authenticity_token: csrfToken, q: {
                    name_cont: $("#search_school_form_name_cont").val(),
                    state_eq:  $("#search_school_form_state").val()
                } },
                dataType: "json",
            }).success(function(data) {
                schools = data['schools']
                document.querySelector('#result_school_list').setOptions(schools);
                $('.loading-overlay').hide();
            }).fail(function() {
                alert('An error occurred.')
                $('.loading-overlay').hide();
            });
        });

        $('#result_school_list').on('change', function(e) {
            if($('#result_school_list').val() != "") {
                school_id = $('#result_school_list').val()
                $.ajax({
                    type: "GET",
                    url: "/mhc/schools/" + school_id + ".json",
                    crossDomain: true,
                    dataType: "json",
                }).success(function(data) {
                    console.log(data)
                    $("#search_school_name").val(data["school"]["name"])
                    $("#search_school_address").val(data["school"]["address"])
                    $("#search_school_suite").val(data["school"]["suite"])
                    $("#search_school_address2").val(data["school"]["address2"])
                    $("#search_school_city").val(data["school"]["city"])
                    $("#search_school_county").val(data["school"]["county"])
                    $("#search_school_state").val(data["school"]["state"])
                    $("#search_school_postal_code").val(data["school"]["postal_code"])
                    $("#search_school_country").val(data["school"]["country"])
                    $("#search_school_contact_method").val(data["school"]["contact_method"])
                    $("#search_school_phone").val(data["school"]["phone"])
                    $("#search_school_fax").val(data["school"]["fax"])
                    $("#search_school_email").val(data["school"]["email"])
                    $('.loading-overlay').hide();

                }).fail(function() {
                    alert('An error occurred.')
                    $('.loading-overlay').hide();
                });
            }
        })

        $('#add_school').on('shown.bs.modal', function () {
            $.ajax({
                url: '<%= get_states_path %>',
                method: 'GET',
                data: { authenticity_token: csrfToken },
                success: function(data) {
                    states = data['states']
                    VirtualSelect.init({
                        options: states,
                        ele: '#add_school_state',
                        search: true,
                        showSelectedOptionsFirst: true
                    });
                }
            })
        })

        $('#search_school').on('shown.bs.modal', function () {
            $.ajax({
                url: '<%= get_states_path %>',
                method: 'GET',
                data: { authenticity_token: csrfToken },
                success: function(data) {
                    states = data['states']
                    VirtualSelect.init({
                        options: states,
                        ele: '#search_school_form_state',
                        search: true,
                        showSelectedOptionsFirst: true
                    });
                }
            })
        })

        $("#add_school_form").submit(function(e){
            e.preventDefault();
            var action = $(this).attr("action");
            var school = {
                name: $("#add_school_name").val(),
                address: $("#add_school_address").val(),
                suite: $("#add_school_suite").val(),
                address2: $("#add_school_address2").val(),
                city: $("#add_school_city").val(),
                county: $("#add_school_county").val(),
                state: $("#add_school_state").val(),
                postal_code: $("#add_school_postal_code").val(),
                country: $("#add_school_country").val(),
                contact_method: $("#add_school_contact_method").val(),
                phone: $("#add_school_phone").val(),
                fax: $("#add_school_fax").val(),
                email: $("#add_school_email").val(),
            }
            $.ajax({
                type: "POST",
                url: action,
                crossDomain: true,
                data: { authenticity_token: csrfToken, school: school },
                dataType: "json",
            }).success(function(data) {
                console.log(data["school"])
                $('#btn-modal-close').trigger('click');
                $('#search_school_button').trigger('click');
                $("#search_school_name").val(data["school"]["name"])
                $("#search_school_address").val(data["school"]["address"])
                $("#search_school_suite").val(data["school"]["suite"])
                $("#search_school_address2").val(data["school"]["address2"])
                $("#search_school_city").val(data["school"]["city"])
                $("#search_school_county").val(data["school"]["county"])
                $("#search_school_state").val(data["school"]["state"])
                $("#search_school_postal_code").val(data["school"]["postal_code"])
                $("#search_school_country").val(data["school"]["country"])
                $("#search_school_contact_method").val(data["school"]["contact_method"])
                $("#search_school_phone").val(data["school"]["phone"])
                $("#search_school_fax").val(data["school"]["fax"])
                $("#search_school_email").val(data["school"]["email"])
                $('.loading-overlay').hide();
            }).fail(function() {
                alert('An error occurred.')
                $('.loading-overlay').hide();
            });
        });
    })
</script>


<style type="text/css">
  .multi-select, .search-select, .single-select {
    padding: 0;
      width: 100%;
      max-width: 1000px;
  }
  .single-select  {
    width: 100%;
    max-width: 1000px;
    padding: 0;
  }
</style>