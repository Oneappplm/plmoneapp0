	<div class="enc-content">
		<div class="container">
	  <%= render "top_nav_buttons"%>
			
			<div class="add-license-content mt-4">
				<div class="row">
					<div class="d-flex align-items-end justify-content-between gap-3">
						<div class="d-flex align-items-center gap-3">
							<h4 class="page-heading">License Record 1</h4>

						   <%= link_to "Edit", mhc_verification_platform_path(page_tab: 'edit_licensure',licensure_id: @provider_licensure.id), class: "btn btn-primary py-1" %>
						</div>
					</div>
					<div class="enc-tabs-wrp mt-3">
						<div class="">
							<button class="btn btn-primary py-1" name="lic-ver-letter" type="button" data-bs-toggle="modal"
							data-bs-target="#verifLetterModal">
								Verification Letter
							</button>
						</div>
						<div class="">
							<button class="btn btn-primary py-1" name="lic-send-contract" type="button">
								Send Contract
							</button>
						</div>
						<div class="">
							<button class="btn btn-primary py-1" name="lic-view-img" type="button">
								View Scanned Images
							</button>
						</div>

					</div>
					<div class="mt-3 row page-applicable">
						<div class="col-xl-5">
							<div class="left-pane">
								<h6 class="offset-md-5">RVA Information</h6>
								<div class="form-row row mt-4">
									<div class="col-xl-4">
										<button class="btn btn-pane bg-alt-grey py-1">
											Request
										</button>
									</div>
									<div class="col-xl-4">
										<button class="btn btn-pane bg-alt-grey py-1">
											Verification
										</button>
									</div>
									<div class="col-xl-4">
										<button class="btn btn-pane bg-alt-grey py-1">
											Audit
										</button>
									</div>
								</div>
								<div class="form-row row mt-2">
									<div class="col-xl-6">
										<button class="btn btn-primary btn-audit btn-sm" data-bs-toggle="modal" data-bs-target="#QAModal" data-information-id="<%= @last_rva_information&.id %>" data-first-name="<%= @provider_personal_information&.first_name %>" data-last-name="<%= @provider_personal_information&.last_name %>" data-personal-information-id="<%= @provider_personal_information&.id %>" data-licensure-id = "<%= @provider_licensure.id %>">
													Quality Audit
										</button>
									</div>
									<div class="col-xl-6">
										<button class="btn btn-pane bg-alt-grey py-1">
											Skip RVA
										</button>
									</div>
									<div class="col-12 m-2">
										<button class="btn text-danger <%= @licensure_rva_information_completed.present? ? '' : 'd-none' %>" data-bs-toggle="modal" data-bs-target="#QAModal" data-information-id="<%= @last_rva_information&.id %>" data-first-name="<%= @provider_personal_information&.first_name %>" data-last-name="<%= @provider_personal_information&.last_name %>" data-personal-information-id="<%= @provider_personal_information&.id %>" id="re-rva">
											Need ReRVA
										</button>
									</div>
								</div>
							</div>
						</div>
						<div class="col-xl-7">
							<div class="right-pane">
								<div class="d-flex align-items-center justify-content-between">
									<h6 class="offset-md-5">Message Board</h6>
									<button class="btn btn-primary py-1" data-bs-toggle="modal"
										data-bs-target="#addCommentModal">
										Add Comment
									</button>
								</div>
								<div class="form-row mt-2">
									<span class="btn span-pane bg-alt-grey py-1" data-bs-toggle="modal"
										data-bs-target="#deleteCommentModal">
										Subject: Incomplete Record
									</span>
								</div>
							</div>
						</div>
					</div>

					<div class="form-row row mt-2">
						<div class="col-xl-4">
							<label for="state">State</label>
							<span class="form-control form-control-lg">
								<%= @provider_licensure.state&.name || "N/A" %>
							</span>
						</div>
						<div class="col-xl-4">
							<label for="type">Type</label>
							<span class="form-control form-control-lg">
								<%= @provider_licensure.license_type || "N/A" %>
							</span>
						</div>
						<div class="col-xl-4">
							<label for="lic-number">License Number</label>
							<span class="form-control form-control-lg">
								<%= @provider_licensure.license_number || "N/A" %>
							</span>
						</div>

					</div>
					<div class="form-row row">
						<div class="col-xl-6">
							<label for="issue-date">Issue Date</label>
							<span class="form-control form-control-lg">
								<%= @provider_licensure.license_issue_date || "N/A" %>
							</span>
						</div>
						<div class="col-xl-6">
							<label for="expiration-date">Expiration Date</label>
							<span class="form-control form-control-lg">
								<%= @provider_licensure.license_expiration_date || "N/A" %>
							</span>
						</div>
					</div>
					<div class="form-row row mt-3">
						<div class="col-xl-6">
							<div class="d-flex align-items-center gap-3">
								<label for="">Do you currently practice under this license/certificate? </label>
								<div class="form-check">
									<input class="form-check-input" type="radio" name="prac-input" id="prac-yes" value="Yes" 
										<%= 'checked' if @provider_licensure.currently_practice_under_this == true %>>
									<label class="form-check-label" for="prac-yes">
										Yes
									</label>
								</div>
								<div class="form-check">
									<input class="form-check-input" type="radio" name="prac-input" id="prac-no" value="No"
										<%= 'checked' if @provider_licensure.currently_practice_under_this == false %>>
									<label class="form-check-label" for="prac-no">
										No
									</label>
								</div>
							</div>
						</div>

						<div class="col-xl-6">
							<div class="d-flex align-items-center gap-3">
								<label for="">Is this your primary license? </label>
								<div class="form-check">
									<input class="form-check-input" type="radio" name="primary-input" id="primary-yes" value="Yes" 
										<%= 'checked' if @provider_licensure.is_primary_license == true %>>
									<label class="form-check-label" for="primary-yes">
										Yes
									</label>
								</div>
								<div class="form-check">
									<input class="form-check-input" type="radio" name="primary-input" id="primary-no" value="No"
										<%= 'checked' if @provider_licensure.is_primary_license == false %>>
									<label class="form-check-label" for="primary-no">
										No
									</label>
								</div>
							</div>
						</div>
					</div>

					<div class="form-row row mt-3">
						<div class="col-xl-6">
							<div class="d-flex align-items-center gap-3">
								<label for="">Does your license/certification level require supervision? </label>
								<div class="form-check">
									<input class="form-check-input" type="radio" name="level-input" id="level-yes" value="Yes" 
										<%= 'checked' if @provider_licensure.level_require_supervision == true %>>
									<label class="form-check-label" for="level-yes">
										Yes
									</label>
								</div>
								<div class="form-check">
									<input class="form-check-input" type="radio" name="level-input" id="level-no" value="No"
										<%= 'checked' if @provider_licensure.level_require_supervision == false %>>
									<label class="form-check-label" for="level-no">
										No
									</label>
								</div>
							</div>
						</div>

						<div class="col-xl-6">
							<div class="d-flex align-items-center gap-3">
								<label for="">Have you ever failed a state license exam? </label>
								<div class="form-check">
									<input class="form-check-input" type="radio" name="failed-input" id="failed-yes" value="Yes" 
										<%= 'checked' if @provider_licensure.failed_state_license_exam == true %>>
									<label class="form-check-label" for="failed-yes">
										Yes
									</label>
								</div>
								<div class="form-check">
									<input class="form-check-input" type="radio" name="failed-input" id="failed-no" value="No"
										<%= 'checked' if @provider_licensure.failed_state_license_exam == false %>>
									<label class="form-check-label" for="failed-no">
										No
									</label>
								</div>
							</div>
						</div>
					</div>

					<% @provider_licensure.provider_supervisings.each do |provider_supervising| %>
						<% license_state = State.find(provider_supervising.license_state) if provider_supervising.license_state.present? %>
						<% state = State.find(provider_supervising.state) if provider_supervising.state.present? %>
						<div class="form-row row mt-3">
							<div class="col-xl-12 right-pane">
								<div class="form-row row">
									<div class="d-flex align-items-center gap-10">
										<h5 class="add-license-pane-t">Supervising Practitioner/Group Information</h5>
									</div>
									<div class="col-xl-5">
										<label for="supervising-prac">Name of Supervising Practitioner/Group:</label>
										<span class="form-control form-control-lg">
											<%= provider_supervising&.name_of_supervising || "N/A" %>
										</span>

									</div>
									<div class="col-xl-6">
										<label for="firstname">Licence State:</label>
										<span class="form-control form-control-lg">
											<%= license_state&.name || "N/A" %>
										</span>
									</div>
								</div>
								<div class="form-row row mt-2">
									<div class="col-xl-6">
										<label for="group-license-type">License Type:</label>
										<span class="form-control form-control-lg">
											<%= provider_supervising&.license_type || "N/A" %>
										</span>
									</div>
									<div class="col-xl-6">
										<label for="group-license-number">License Number:</label>
										<span class="form-control form-control-lg">
											<%= provider_supervising&.license_number || "N/A" %>
										</span>
									</div>
								</div>
								<div class="form-row row mt-2">
									<div class="col-xl-6">
										<label for="group-facility">Facility</label>
										<span class="form-control form-control-lg">
											<%= provider_supervising&.facility || "N/A" %>
										</span>
									</div>
									<div class="col-xl-6">
										<label for="group-address">Address:</label>
										<span class="form-control form-control-lg">
											<%= provider_supervising&.address || "N/A" %>
										</span>
									</div>
								</div>
								<div class="form-row row mt-2">
									<div class="col-xl-6">
										<label for="group-suite">Suite/Dept/Mail Stop:</label>
										<span class="form-control form-control-lg">
											<%= provider_supervising&.mail_stop || "N/A" %>
										</span>
									</div>
									<div class="col-xl-6">
										<label for="group-add-address">Additional Address:</label>
										<span class="form-control form-control-lg">
											<%= provider_supervising&.address2 || "N/A" %>
										</span>
									</div>
								</div>
								<div class="form-row row mt-2">
									<div class="col-xl-6">
										<label for="group-city">City:</label>
										<span class="form-control form-control-lg">
											<%= provider_supervising&.city || "N/A" %>
										</span>
									</div>
									<div class="col-xl-6">
										<label for="group-county">County:</label>
										<span class="form-control form-control-lg">
											<%= provider_supervising&.country || "N/A" %>
										</span>
									</div>
								</div>
								<div class="form-row row mt-2">
									<div class="col-xl-4">
										<label for="group-state">State/Province:</label>
										<span class="form-control form-control-lg">
											<%= state&.name || "N/A" %>
										</span>
									</div>
									<div class="col-xl-4">
										<label for="group-zip">Zip/Postal Code:</label>
										<span class="form-control form-control-lg">
											<%= provider_supervising&.zipcode || "N/A" %>
										</span>
									</div>
									<div class="col-xl-4">
										<label for="group-country">Country:</label>
										<span class="form-control form-control-lg">
											<%= provider_supervising&.country || "N/A" %>
										</span>
									</div>
								</div>
								<div class="form-row row mt-2">
									<div class="col-xl-4">
										<label for="group-phone">Phone Number:</label>
										<span class="form-control form-control-lg">
											<%= provider_supervising&.phone_number || "N/A" %>
										</span>
									</div>
									<div class="col-xl-4">
										<label for="group-fax">Fax Number:</label>
										<span class="form-control form-control-lg">
											<%= provider_supervising&.fax_number || "N/A" %>
										</span>
									</div>
									<div class="col-xl-4">
										<label for="group-email">Email Address:</label>
										<span class="form-control form-control-lg">
											<%= provider_supervising&.email_address || "N/A" %>
										</span>
									</div>
								</div>
								</div>
							</div>
						</div>
					<% end %>

					<div class="form-row row mt-3">
						<div class="col-xl-6">
							<div class="d-flex align-items-center gap-3">
								<label for="">Show on tickler?</label>
								<div class="form-check">
									<input class="form-check-input" type="radio" name="inter-input" id="inter-yes" value="Yes" 
										<%= 'checked' if @provider_licensure.show_on_tickler == true %>>
									<label class="form-check-label" for="prac-yes">
										Yes
									</label>
								</div>
								<div class="form-check">
									<input class="form-check-input" type="radio" name="inter-input" id="inter-no" value="No"
										<%= 'checked' if @provider_licensure.show_on_tickler == false %>>
									<label class="form-check-label" for="prac-no">
										No
									</label>
								</div>
							</div>
						</div>

						<div class="form-row row mt-3">
							<div class="col-xl-25">
								<label for="license-comment">Please List any comments</label>
								<span class="form-control form-control-lg">
									<%= @provider_licensure.license_comment %>
								</span>
							</div>
						</div>
				</div>
			</div>
		</div>
	</div>
	<% if @provider_licensure.persisted? %>
			<div class="col-12 text-left" style="margin-top: 10px;">
					<%= button_to 'Delete', 
							mhc_provider_licensure_path(@provider_licensure), 
							method: :delete, 
							data: { confirm: 'Are you sure you want to delete this training detail?' }, 
							class: 'btn btn-danger', 
							style: 'width: 200px;' %>
			</div>
	<% end %>
	<!-- Add Comment Modal -->
	<div class="modal fade" id="addCommentModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-body">
					<div class="content">
						<div class="modal-title">
							<h6 class="offset-md-5">Add Comment</h6>
							<button class="btn btn-cancel" data-bs-dismiss="modal">Cancel</button>
						</div>
						<form action="">
							<div class="form-row mt-3">
								<label for="">Subject:</label>
								<input type="text" class="form-control">
							</div>
							<div class="form-row">
								<label for="">Message:</label>
								<textarea name="" id="" cols="30" rows="5" class="form-control"></textarea>
							</div>
						</form>
						<div class="form-row mt-3 d-flex justify-content-center">
							<button class="btn btn-primary py-1">Post Comment</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Delete Comment Modal -->
	<div class="modal fade" id="deleteCommentModal" tabindex="-1" aria-labelledby="exampleModalLabel"
		aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-body">
					<div class="content">
						<div class="modal-title">
							<h6 class="offset-md-5">Comment</h6>
							<button class="btn btn-cancel" data-bs-dismiss="modal">Cancel</button>
						</div>
						<form action="">
							<div class="form-row mt-3">
								<label for="">Subject:</label>
								<input type="text" class="form-control">
							</div>
							<div class="form-row">
								<label for="">Message:</label>
								<textarea name="" id="" cols="30" rows="5" class="form-control"></textarea>
							</div>
						</form>
						<div class="form-row mt-3 d-flex justify-content-center">
							<button class="btn btn-red">Delete Comment</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Quality Audit Modal -->
	          <div class="modal fade" id="QAModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
              <div class="modal-dialog modal-lg">
                <div class="modal-content">
                  <div class="modal-body">
                    <div id="qaModalMessage" class="alert alert-info d-none"></div>
                    <div class="content">
                      <div class="modal-title">
                        <h6 class="">Quality Audit</h6>
                        <button class="btn btn-cancel" data-bs-dismiss="modal">Cancel</button>
                      </div>
                      <%= form_with model: @rva_information, url: mhc_verification_platform_generate_rva_information_path, method: :post, id: 'audit-form' do |f| %>

                        <%= hidden_field_tag :id, @last_rva_information&.id %>
                        <%= hidden_field_tag :personal_info_id %>
						<%= hidden_field_tag :practice_licensure_id %>

                        <%= hidden_field_tag :first_name %>
                        <%= hidden_field_tag :last_name %>
					    <%= hidden_field_tag :license_number, @provider_licensure.license_number %>

                        <div class="form-row row mt-3">
                          <div class="col-xl-12">
                            <div class="card other-name-card">
                              <div class="card-header bg-secondary rounded-0">
                                <h6 class="form-heading text-white">Request</h6>
                              </div>
                              <div class="card-body">
                                <div class="d-flex justify-content-end gap-2">
                                  <button class="btn btn-primary py-1" type="button">View Request History</button>
                                  <button class="btn btn-primary py-1" type="button">View Webcrawler Image Archive</button>
                                </div>
                                <hr class="form-hr">
                                <div class="row pt-3 pb-3">
                                  <div class="col-md-6">
																		<button class="btn btn-sm btn-light <%= @last_rva_information.present? ? '' : 'btn-disabled' %>" 
                                             id="send-request-btn" 
                                             <%= 'disabled' if @last_rva_information.present? %>>
                                       Send Request
                                    </button>
                                  </div>
                                  <div class="col-md-6">
																		<span class="font-bold sent-request" style="line-height: 38px;"><%= @last_rva_information&.send_request %></span>
                                  </div>
                                </div>
                                <hr class="form-hr">
                                <div class="row">
                                  <div class="col-md-6">
                                    <label for="">Requested By:</label>
                                  </div>
                                  <div class="col-md-6">
																		<span class="font-bold requested-by"><%= @last_rva_information&.requested_by %></span>
                                  </div>
                                </div>
                                <hr class="form-hr">
                                <div class="row">
                                  <div class="col-md-6">
                                    <label for="">Requested Date:</label>
                                  </div>
                                  <div class="col-md-6">
																		<span class="font-bold requested-date"><%= @last_rva_information&.requested_date %></span>
                                  </div>
                                </div>
                                <hr class="form-hr">
                                <div class="form-row d-flex align-items-center gap-3">
                                  <label for="">Requested Method:</label>
																	   <%= f.radio_button :requested_method, 'AutoFax', id: 'method-autofax', checked: (@last_rva_information.present? && @last_rva_information.requested_method == "AutoFax") %>
                                     <label class="form-check-label" for="method-autofax">AutoFax</label>
     
                                     <%= f.radio_button :requested_method, 'E-Mail', id: 'method-email', checked: (@last_rva_information.present? && @last_rva_information.requested_method == "E-Mail") %>
                                     <label class="form-check-label" for="method-email">E-Mail</label>
     
                                     <%= f.radio_button :requested_method, 'Letter', id: 'method-letter', checked: (@last_rva_information.present? && @last_rva_information.requested_method == "Letter") %>
                                     <label class="form-check-label" for="method-letter">Letter</label>
     
                                     <%= f.radio_button :requested_method, 'Phone', id: 'method-phone', checked: (@last_rva_information.present? && @last_rva_information.requested_method == "Phone") %>
                                     <label class="form-check-label" for="method-phone">Phone</label>
     
                                     <%= f.radio_button :requested_method, 'Website', id: 'method-website', checked: (@last_rva_information.present? && @last_rva_information.requested_method == "Website") %>
                                     <label class="form-check-label" for="method-website">Website</label>
                                </div>
                                <span>The default contact method is letter.</span>
                                <hr class="form-hr">
                                <div class="form-row row">
                                  <div class="col-xl-6">
                                    <%= f.label :required_fee_amount, "Required Fee Amount:" %>
																		<%= f.text_field :required_fee_amount, 
                                     class: 'form-control req-fee-amount', 
                                     placeholder: "Type here...", 
                                     value: @last_rva_information&.required_fee_amount, 
                                     disabled: true %>
                                  </div>
                                  <div class="col-xl-6">
                                    <%= f.label :check_payable_to, "Check Payable To:" %>
																		<%= f.text_field :check_payable_to, 
                                       class: 'form-control', 
                                       placeholder: "Type here...", 
                                       value: @last_rva_information&.check_payable_to, 
                                       disabled: true %>
                                  </div>
                                </div>
                                <hr class="form-hr">
                                <div class="form-row mt-2">
																	<%= f.check_box :include_delineation, 
                                     id: 'inc-delineation-check', 
                                     value: "Include Delineation of Privileges", 
                                     checked: @last_rva_information&.include_delineation == true %>
                                  <%= f.label :include_delineation, "Include Delineation of Privileges", for: 'inc-delineation-check' %>
                                </div>
                                <hr class="form-hr">
                                <div class="form-row d-flex align-items-center gap-3">
                                  <label for="">Check has generated?</label>
																	<%= f.radio_button :check_generated, 'true', 
                                           id: 'check-generate-yes', 
                                           disabled: true, 
                                           checked: @last_rva_information&.check_generated == true %>
                                  <label for="check-generate-yes">Yes</label>
																	<%= f.radio_button :check_generated, 'false', 
                                     id: 'check-generate-no', 
                                     disabled: true, 
                                     checked: @last_rva_information&.check_generated == false %>
                                  <label for="check-generate-no">No</label>
                                </div>
                                <hr class="form-hr">
                                <div class="form-row d-flex align-items-center gap-3">
                                  <label for="">Received Status:</label>
																	<%= f.radio_button :received_status, 'Yes', 
                                         id: 'received-status-yes', 
                                         disabled: true, 
                                         checked: @last_rva_information&.received_status == 'Yes' %>
                                  <label for="received-status-yes">Yes</label>
																	<%= f.radio_button :received_status, 'No', 
                                           id: 'received-status-no', 
                                           disabled: true, 
                                           checked: @last_rva_information&.received_status == 'No' %>
                                  <label for="received-status-no">No</label>
                                </div>
                                <hr class="form-hr">
                                <div class="row">
                                  <div class="col-md-6">
                                    <label for="">Received by:</label>
                                  </div>
                                  <div class="col-md-6">
																		<span class="font-bold received-by">
                                        <%= @last_rva_information&.received_by.presence || ' ' %>
                                    </span>
                                  </div>
                                </div>
                                <hr class="form-hr">
                                <div class="row">
                                  <div class="col-md-6">
                                    <label for="">Received date:</label>
                                  </div>
                                  <div class="col-md-6">
																		<span class="font-bold received-date">
																			<%= @last_rva_information&.received_date.presence || ' ' %>
																		</span>
                                  </div>
                                </div>
                                <hr class="form-hr">
                                <div class="form-row">
                                  <%= f.label :comments, "Comments:" %>
																	<%= f.text_area :comments, rows: 3, class: 'form-control request-comment', value: @last_rva_information&.comments%>
                                </div>
                                <div class="form-row d-flex justify-content-end gap-2 mt-3">
                                  <button class="btn btn-primary py-1" type="button">View Received Images</button>
																	<button class="btn btn-primary py-1" type="button" <%= 'disabled' if @last_rva_information.present? %>>Save Request</button>
                                  <button class="btn btn-primary py-1" type="button" <%= 'disabled' if !@last_rva_information.present? %>>Restart Request</button>
                                </div>
                                <div class="row mt-3">
																  <div class="col-md-3">
																		<button class="btn btn-primary py-1" id="run-licensure-webcrawler-btn" type="button">Run Webcrawler</button>
																  </div>
																	<div class="col-md-9">
																		<div class="row justify-content-end" id="licensure-crawler-link">
																			<% @licensure_webcrawler_logs&.each do |crawler_log| %>
																				<div class="col-md-6">
																					<div class="text-decoration-underline">
																						<%= link_to "#{File.basename(crawler_log.filepath.url)}", crawler_log.filepath.url, target: '_blank' %>
																					</div>
																				</div>
																				<div class="col-md-3">
																					<div class="date-time d-flex">
																						<span><%= crawler_log.created_at.strftime('%Y/%m/%d') %></span>
																						<span class="ms-2"><%= crawler_log.created_at.strftime('%H:%M') %></span>
																					</div>
																				</div>
																			<% end %>
																		</div>
																	</div>
																</div>
                              </div>
                            </div>
                          </div>
                        </div>

                        <div class="form-row row mt-3">
                          <div class="col-xl-12">
                            <div class="card other-name-card">
                              <div class="card-header bg-secondary rounded-0">
                                <h6 class="form-heading text-white">Verification</h6>
                              </div>  
                              <div class="card-body">
                                <div class="form-row row">
                                  <div class="col-md-6">
                                    <%= f.label :source_name, 'Source Name:' %>
                                  </div>
                                  <div class="col-md-6">  
                                    <%= f.select :source_name, options_for_select([['ABSA', 'ABSA'] , ['Behavior Analyst Certification Board', 'Behavior Analyst Certification Board'], ['City/County Business Tax Receipt', 'City/County Business Tax Receipt'], ['Dept. of Children and Family Services', 'Dept. of Children and Family Services'] , ['NURSYS', 'NURSYS'], ['Pharmacy', 'Pharmacy'], ['Radioactive Material License', 'Radioactive Material License'], ['State Board', 'State Board'], ['State of Florida (AHCA)', 'State of Florida (AHCA)'] , ['Texas Medical Board', 'Texas Medical Board'] , ['Unable to Verify', 'Unable to Verify']], selected: @last_rva_information&.source_name.present? ? @last_rva_information&.source_name : ''), { include_blank: 'Select option' }, class: 'form-select' %>
                                  </div>
                                </div>
                                <hr>
                                <div class="form-row row">
                                  <div class="col-md-6">
                                    <%= f.label :source_date, 'Source Date:' %>
                                  </div>
                                  <div class="col-md-6">  
																		<%= f.date_field :source_date, required: true, class: "form-control", value: @last_rva_information&.source_date %>
                                  </div>
                                </div>
                                <hr>
                                <div class="form-row row">
                                  <div class="col-md-6">
                                    <%= f.label :status, 'Status:' %>
                                  </div>
                                  <div class="col-md-6">
																		<%= f.select :status, options_for_select([
																			['ACTIVE', 'ACTIVE'],
																			['ACTIVE - ON PROBATION', 'ACTIVE - ON PROBATION'],
																			['ACTIVL - RESTRICTED', 'ACTIVL - RESTRICTED'],
																			['ACTIVE - WITH CONDITIONS', 'ACTIVE - WITH CONDITIONS'],
																			['ACTIVE EMERITUS', 'ACTIVE EMERITUS'],
																			['Active in Renewal', 'Active in Renewal'],
																			['Active Physician', 'Active Physician'],
																			['ACTIVE WITH CONDITIONS', 'ACTIVE WITH CONDITIONS'],
																			['ACTIVE WITH RESTRICTIONS', 'ACTIVE WITH RESTRICTIONS'],
																			['Active/Prosee', 'Active/Prosee'],
																			['ACTIVLI', 'ACTIVLI'],
																			['CANCELLED', 'CANCELLED'],
																			['Certified', 'Certified'],
																			['Clear', 'Clear'],
																			['Clear/Active', 'Clear/Active'],
																			['Conditional', 'Conditional'],
																			['Conditional/Active', 'Conditional/Active'],
																			['Current', 'Current'],
																			['CURRENT - ACTIVL', 'CURRENT - ACTIVL'],
																			['CURRENT - INACTIVE', 'CURRENT - INACTIVE'],
																			['CURRENT - ACTIVE', 'CURRENT - ACTIVE'],
																			['CURRENT/ACTIVE', 'CURRENT/ACTIVE'],
																			['Deceased', 'Deceased'],
																			['DECEASED/CLOSED', 'DECEASED/CLOSED'],
																			['Delinquent', 'Delinquent'],
																			['DELINQUENT - LICENSE RENEWAL HAS NOT BEEN PAID. NO PRACTICE IS PERMITTED.', 'DELINQUENT - LICENSE RENEWAL HAS NOT BEEN PAID. NO PRACTICE IS PERMITTED.'],
																			['DELINQUENT', 'DELINQUENT'],
																			['DELINQUENT/ACTIVE', 'DELINQUENT/ACTIVE'],
																			['DELINQUENT/INACTIVE', 'DELINQUENT/INACTIVE'],
																			['Discp-Relinq', 'Discp-Relinq'],
																			['DISCP-RELINQ/', 'DISCP-RELINQ/'],
																			['Emerg.Restrict/Active', 'Emerg.Restrict/Active'],
																			['Emerg.Suspend/ACTIVE', 'Emerg.Suspend/ACTIVE'],
																			['Expired', 'Expired'],
																			['EXPIRED-CAN RENEW', 'EXPIRED-CAN RENEW'],
																			['EXPIRED-MUST REAPPLY', 'EXPIRED-MUST REAPPLY'],
																			['Good Standing', 'Good Standing'],
																			['In Renewal', 'In Renewal'],
																			['Inactive', 'Inactive'],
																			['INACTIVE-PAID', 'INACTIVE-PAID'],
																			['INCOMPLETE RENEWAL', 'INCOMPLETE RENEWAL'],
																			['Lapsed', 'Lapsed'],
																			['LICENSE CANCELED', 'LICENSE CANCELED'],
																			['LICENSE RENEWED & CURRENT', 'LICENSE RENEWED & CURRENT'],
																			['LICENSE RENEWED & INACTIVE', 'LICENSE RENEWED & INACTIVE'],
																			['LICENSE SURRENDERED', 'LICENSE SURRENDERED'],
																			['Licensed', 'Licensed'],
																			['MILITARY ACTIVE/', 'MILITARY ACTIVE/'],
																			['Not Registered', 'Not Registered'],
																			['Null & Void', 'Null & Void'],
																			['NULL AND VOID/', 'NULL AND VOID/'],
																			['Obligations/Active', 'Obligations/Active'],
																			['ON PROBATION', 'ON PROBATION'],
																			['Pending', 'Pending'],
																			['Probation', 'Probation'],
																			['Probation/Active', 'Probation/Active'],
																			['Provisional', 'Provisional'],
																			['Registered', 'Registered'],
																			['RENEWAL PENDING', 'RENEWAL PENDING'],
																			['RENEWAL PENDING - RENEWAL FEES MAY HAVE BEEN PAID, HOWEVER, THE LICENSEE HAS NOT COMPLIED WITH ALL THE RENEWAL REQUIREMENTS OR THE RENEWAL MAY BE DELAYED PENDING.', 'RENEWAL PENDING - RENEWAL FEES MAY HAVE BEEN PAID, HOWEVER, THE LICENSEE HAS NOT COMPLIED WITH ALL THE RENEWAL REQUIREMENTS OR THE RENEWAL MAY BE DELAYED PENDING.'],
																			['Renewed/Current', 'Renewed/Current'],
																			['RENEWED/CURRENT, ACCUSATION FILED', 'RENEWED/CURRENT, ACCUSATION FILED'],
																			['RENEWED/CURRENT, CITATION', 'RENEWED/CURRENT, CITATION'],
																			['RENEWED/CURRENT, EMPLOYED AT ONLY 1 LOCATION', 'RENEWED/CURRENT, EMPLOYED AT ONLY 1 LOCATION'],
																			['RENEWED/CURRENT, EMPLOYED OR ASSIGNED IN MULTIPLE LOCATIONS', 'RENEWED/CURRENT, EMPLOYED OR ASSIGNED IN MULTIPLE LOCATIONS'],
																			['RENEWED/CURRENT, HOME OR MAILING ADDRESS', 'RENEWED/CURRENT, HOME OR MAILING ADDRESS'],
																			['RENEWED/CURRENT, MALPRACTICE JUDGMENT', 'RENEWED/CURRENT, MALPRACTICE JUDGMENT'],
																			['RENEWED/CURRENT, NAME CHANGE', 'RENEWED/CURRENT, NAME CHANGE'],
																			['RENEWED/CURRENT, PROBATION TERMINATED', 'RENEWED/CURRENT, PROBATION TERMINATED'],
																			['RENEWED/CURRENT, PUBLIC REPRIMAND', 'RENEWED/CURRENT, PUBLIC REPRIMAND'],
																			['RENEWED/CURRENT, REVOKED, STAYED, PROBATION', 'RENEWED/CURRENT, REVOKED, STAYED, PROBATION'],
																			['RENEWED/CURRENT, SELF EMPLOYED AT 1 LOCATION', 'RENEWED/CURRENT, SELF EMPLOYED AT 1 LOCATION'],
																			['Restricted', 'Restricted'],
																			['Retired', 'Retired'],
																			['RETIRED/', 'RETIRED/'],
																			['REVOKED', 'REVOKED'],
																			['Superceded', 'Superceded'],
																			['Surrendered', 'Surrendered'],
																			['Suspended', 'Suspended'],
																			['Temporary', 'Temporary'],
																			['Terminated', 'Terminated'],
																			['Unable to verify', 'Unable to verify'],
																			['Valid', 'Valid'],
																			['VOL RELINQUISH/', 'VOL RELINQUISH/'],
																			['Vol-Relinq', 'Vol-Relinq'],
																			['VOL-RELINQ/', 'VOL-RELINQ/'],
																			['Volun.Restrict/ACTIVE', 'Volun.Restrict/ACTIVE'],
																			['Volun.Withdraw/ACTIVE', 'Volun.Withdraw/ACTIVE'],
																			['VOLUNTARY SURRENDER', 'VOLUNTARY SURRENDER']
																		], @last_rva_information&.status), { include_blank: 'Select option' }, class: 'form-select' %>

                                  </div>
                                </div>
                                <hr>
                                <div class="card">
                                  <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <h6 class="form-heading">Adverse Action</h6>
                                    </div>    
                                    <div class="form-row d-flex align-items-center gap-3 mt-1">
																		 <%= f.select :adverse_action, options_for_select([
																			['None', 'None'],
																			['Accusation', 'Accusation'],
																			['Administrative Penalty', 'Administrative Penalty'],
																			['Arbitration Award', 'Arbitration Award'],
																			['Board Action', 'Board Action'],
																			['Board Order Cleared', 'Board Order Cleared'],
																			['CE RQD NOT ADEQ', 'CE RQD NOT ADEQ'],
																			['Citation', 'Citation'],
																			['COE', 'COE'],
																			['Consent Order', 'Consent Order'],
																			['Delinquent', 'Delinquent'],
																			['Denial of initial', 'Denial of initial'],
																			['Denial of renewal', 'Denial of renewal'],
																			['Discipline on File', 'Discipline on File'],
																			['Disclosure Response Discrepancy', 'Disclosure Response Discrepancy'],
																			['DISP ST/FED GOV', 'DISP ST/FED GOV'],
																			['DUPLICATE LICENSE', 'DUPLICATE LICENSE'],
																			['ETHICS COURSE REQUIRED', 'ETHICS COURSE REQUIRED'],
																			['Expired', 'Expired'],
																			['Expiring prior to committee', 'Expiring prior to committee'],
																			['Failed CE Audit', 'Failed CE Audit'],
																			['FIN STMT INADEQ', 'FIN STMT INADEQ'],
																			['Fine', 'Fine'],
																			['HOSP DISCIPLINE', 'HOSP DISCIPLINE'],
																			['Inactive', 'Inactive'],
																			['Inadequate attestation response', 'Inadequate attestation response'],
																			['Incomplete Renewal', 'Incomplete Renewal'],
																			['Incorrect Address', 'Incorrect Address'],
																			['Incorrect attestation response', 'Incorrect attestation response'],
																			['Judgment', 'Judgment'],
																			['Lapsed', 'Lapsed'],
																			['Limitation or restriction', 'Limitation or restriction'],
																			['Malpractice Record', 'Malpractice Record'],
																			['Name Change', 'Name Change'],
																			['No record found', 'No record found'],
																			['Obligations', 'Obligations'],
																			['Other', 'Other'],
																			['PASSED CE AUDIT', 'PASSED CE AUDIT'],
																			['Pending', 'Pending'],
																			['PROB COMPLETED', 'PROB COMPLETED'],
																			['Probation', 'Probation'],
																			['PROBATION TERMINATED', 'PROBATION TERMINATED'],
																			['Probation/Active', 'Probation/Active'],
																			['Public Complaint', 'Public Complaint'],
																			['Publicly available fine/monetary penalty', 'Publicly available fine/monetary penalty'],
																			['Publicly available negative action or finding', 'Publicly available negative action or finding'],
																			['Reprimand or censure', 'Reprimand or censure'],
																			['Retired', 'Retired'],
																			['Revocation', 'Revocation'],
																			['See AFE, CFE, GFE', 'See AFE, CFE, GFE'],
																			['See previous order', 'See previous order'],
																			['SELECT CE AUDIT', 'SELECT CE AUDIT'],
																			['Surrender', 'Surrender'],
																			['Suspended', 'Suspended'],
																			['Suspension', 'Suspension'],
																			['TEMP CE WAIVER', 'TEMP CE WAIVER'],
																			['Terminated', 'Terminated'],
																			['Unable to verify', 'Unable to verify'],
																			['Under Board Order', 'Under Board Order'],
																			['Voluntary surrender', 'Voluntary surrender'],
																			['Yes', 'Yes']
																		], @last_rva_information&.adverse_action), { include_blank: 'Select option' }, class: 'form-select' %>
																		</div>
                                    <div class="form-row row">
                                      <div class="col-xl-6">
                                        <%= f.label :other_details, 'Other:' %>
																				<%= f.text_area :other_details, rows: 5, class: 'form-control', value: @last_rva_information&.other_details  %>
                                      </div>
                                      <div class="col-xl-6">
                                        <%= f.label :adverse_action_comments, 'Comments:' %>
																				<%= f.text_area :adverse_action_comments, rows: 5, class: 'form-control', value: @last_rva_information&.adverse_action_comments  %>
                                      </div>
                                    </div>
                                    <div class="form-row d-flex align-items-center gap-2 mt-1">
                                       <%= f.radio_button :adverse_action_status, 'Open', 
                                                          id: 'verif-open', 
                                                          checked: @last_rva_information&.adverse_action_status == 'Open' %>
                                       <%= f.label :adverse_action_status, 'Open', for: 'verif-open' %>
  
                                       <%= f.radio_button :adverse_action_status, 'Close', 
                                                          id: 'verif-close', 
                                                          checked: @last_rva_information&.adverse_action_status == 'Close' %>
                                       <%= f.label :adverse_action_status, 'Close', for: 'verif-close' %>
                                    </div>
                                    <div class="form-row d-flex align-items-center gap-2">
                                      <%= f.label :in_good_standing, 'In Good Standing?' %>
																			<%= f.radio_button :in_good_standing, 'Yes', 
																												id: 'good-standing-yes', 
																												checked: @last_rva_information&.in_good_standing == true %>
																			<%= f.label :in_good_standing, 'Yes', 
																								for: 'good-standing-yes', 
																								class: 'form-check-label' %>

																			<%= f.radio_button :in_good_standing, 'No', 
																												id: 'good-standing-no', 
																												checked: @last_rva_information&.in_good_standing == false %>
																			<%= f.label :in_good_standing, 'No', 
																								for: 'good-standing-no', 
																								class: 'form-check-label' %>
                                    </div>
                                  </div>
                                </div>
                                <!-- Verification Errors Section -->
                                <div class="form-row row mt-3">
                                  <div class="col-xl-12">
                                    <div class="card other-name-card">
                                      <div class="card-body">
                                        <h6 class="form-heading">Verification Errors</h6>
                                        <div class="form-row row">
                                          <div class="col-xl-6">
                                            <%= f.label :error_type, 'Error:' %>
                                            <%= f.select :error_type, options_for_select([
																							['None', 'None'],
																							['Currently practice under license', 'Currently practice under license'],
																							['Expiration Date', 'Expiration Date'],
																							['Issue Date', 'Issue Date'],
																							['License Number', 'License Number'],
																							['Other', 'Other'],
																							['Primary License', 'Primary License'],
																							['Require Supervision', 'Require Supervision'],
																							['State', 'State'],
																							['Type', 'Type']
																						], @last_rva_information&.error_type || 'None'), { include_blank: 'Select option' }, class: 'form-select' %>

                                          </div>
                                          <div class="col-xl-6">
                                            <%= f.label :error_comments, 'Comments:' %>
																						<%= f.text_area :error_comments, rows: 3, class: 'form-control', value: @last_rva_information&.error_comments %>
                                          </div>
                                        </div>
                                        <div class="d-flex align-items-center justify-content-between mt-3">
                                          <button type="button" class="btn btn-primary py-1">Add Another Error</button>
                                          <button type="button" class="btn btn-danger">Remove</button>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                <!-- Correct Information Section -->
                                <div class="form-row row mt-3">
                                  <div class="col-xl-12">
                                    <div class="card other-name-card">
                                      <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-center">
                                          <h6 class="form-heading">Correct Information</h6>
                                          <div class="d-flex gap-2">
                                            <button class="btn btn-primary py-1">Verified</button>
                                            <button class="btn btn-primary py-1">Verify and Update with Correct Information</button>
                                          </div>
                                        </div>
                                        <div class="form-row row mt-3">
                                          <div class="col-xl-6">
                                            <%= f.label :correct_info_selected, 'Select Correct Info:' %>
																						<%= f.select :correct_info_selected, options_for_select([
																							['Currently practice under license', 'Currently practice under license'],
																							['Expiration Date', 'Expiration Date'],
																							['Issue Date', 'Issue Date'],
																							['License Number', 'License Number'],
																							['Primary License', 'Primary License'],
																							['Require Supervision', 'Require Supervision'],
																							['State', 'State'],
																							['Type', 'Type']
																						],  @last_rva_information&.correct_info_selected), { include_blank: 'Select option' }, class: 'form-select' %>

                                          </div>
                                          <div class="col-xl-6">
                                            <%= f.label :correct_info_text, 'Enter Details:' %>
																						<%= f.text_field :correct_info_text, class: 'form-control', value: @last_rva_information&.correct_info_text %>
                                          </div>
                                        </div>
                                        <div class="d-flex align-items-center justify-content-between mt-3">
                                          <button type="button" class="btn btn-primary py-1">Add</button>
                                          <button type="button" class="btn btn-danger">Remove</button>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                <hr class="form-hr">
                                <div class="row mt-5">
                                  <div class="col-md-6">
                                    <label for="">Verification Status:</label>
                                  </div>
                                  <div class="col-md-6">
																		<span class="font-bold verification-status"><%= @last_rva_information&.verification_status.presence || '' %></span>
                                  </div>
                                </div>
                                <hr class="form-hr">
                                <div class="row">
                                  <div class="col-md-6">
                                    <label for="">Notification Status:</label>
                                  </div>
                                  <div class="col-md-6">
																		<span class="font-bold notification-status"><%= @last_rva_information&.notification_status.presence || '' %></span>
                                  </div>
                                </div>
                                <hr class="form-hr">
                                <div class="row">
                                  <div class="col-md-6">
                                    <label for="">Verification Date:</label>
                                  </div>
                                  <div class="col-md-6">
																		<span class="font-bold verification-date"><%= @last_rva_information&.verification_date.presence || '' %></span>
                                  </div>
                                </div>
                                <hr class="form-hr">
                                <div class="row">
                                  <div class="col-md-6">
                                    <label for="">Verifier:</label>
                                  </div>
                                  <div class="col-md-6">
																		<span class="font-bold verifier"><%= @last_rva_information&.verifier.presence || '' %></span>
                                  </div>
                                </div>
                                <hr class="form-hr">

                                <!-- Comments and Save Button -->
                                <div class="form-row row mt-3">
                                  <div class="col-xl-12">
                                    <%= f.label :verification_comments, 'Comments:' %>
																		<%= f.text_area :verification_comments, rows: 3, class: 'form-control', value: @last_rva_information&.verification_comments %>
                                  </div>
                                </div>
                                <div class="d-flex justify-content-end gap-2 mt-3">
                                  <%= f.button 'Save Verification', class: 'btn btn-primary py-1', id: 'verification-btn' %>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="form-row row mt-3">
                          <div class="card other-name-card">
                            <div class="card-body">
                              <h6 class="form-heading">Audit</h6>

                              <div class="form-row row mt-3">
                                <div class="col-xl-12">
                                  <div class="card other-name-card">
                                    <div class="card-body">
                                      <h6 class="form-heading">Reasons</h6>
                                      <div class="form-row row">
                                        <div class="col-xl-6">
                                          <%= f.label :audit_reason, 'Reason:' %>
																					<%= f.select :audit_reason, options_for_select([
																						['Adverse Action Not Recorded', 'Adverse Action Not Recorded'],
																						['Expiration Date Incorrect', 'Expiration Date Incorrect'],
																						['Expires Before 30 Days', 'Expires Before 30 Days'],
																						['Issue Date Incorrect', 'Issue Date Incorrect'],
																						['License Number Incorrect', 'License Number Incorrect'],
																						['Primary License Status Incorrect', 'Primary License Status Incorrect'],
																						['Show on Ticker Status Incorrect', 'Show on Ticker Status Incorrect'],
																						['Source Date Greater Than 90 Days', 'Source Date Greater Than 90 Days'],
																						['Source Has Incorrect', 'Source Has Incorrect'],
																						['Source Name Incorrect', 'Source Name Incorrect'],
																						['State Incorrect', 'State Incorrect'],
																						['Treatment: Incorrect Information Entered', 'Treatment: Incorrect Information Entered'],
																						['Treatment: Necessary Information Not Entered', 'Treatment: Necessary Information Not Entered'],
																						['Treatment: Unnecessary Information Entered', 'Treatment: Unnecessary Information Entered'],
																						['Type Incorrect', 'Type Incorrect'],
																						['Verification Not Uploaded', 'Verification Not Uploaded'],
																						['Verification Status Incorrect', 'Verification Status Incorrect']
																					],    @last_rva_information&.audit_reason), { include_blank: 'Select option' }, class: 'form-select' %>

                                        </div>
                                        <div class="col-xl-6">
                                          <%= f.label :audit_reason_comments, 'Comments:' %>
																					<%= f.text_field :audit_reason_comments, class: 'form-control', value: @last_rva_information&.audit_reason_comments %>
                                        </div>
                                      </div>
                                      <div class="d-flex align-items-center justify-content-between mt-3">
                                        <%= button_tag 'Add Another Reason', class: 'btn btn-primary py-1', type: 'button' %>
                                        <%= button_tag 'Remove', class: 'btn btn-danger', type: 'button' %>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>

                              <div class="form-row d-flex align-items-center gap-3">
                                <%= f.label :audit_status, 'Audit Status:' %>
																<%= f.radio_button :audit_status, 'Pass', 
																										id: 'audit-status-pass', 
																										class: 'form-check-input', 
																										required: true, 
																										checked: @last_rva_information&.audit_status == true %>
																<%= f.label :audit_status, 'Pass', 
																							for: 'audit-status-pass', 
																							class: 'form-check-label' %>

																<%= f.radio_button :audit_status, 'Fail', 
																										id: 'audit-status-fail', 
																										class: 'form-check-input', 
																										required: true, 
																										checked: @last_rva_information&.audit_status == false %>
																<%= f.label :audit_status, 'Fail', 
																							for: 'audit-status-fail', 
																							class: 'form-check-label' %>
                              </div>
                              <hr class="form-hr">

                              <div class="row">
                                <div class="col-md-6">
                                  <label for="">Audit Date:</label>
                                </div>
                                <div class="col-md-6">
																	<span class="font-bold" id="rva_information_audit_date"><%= @last_rva_information&.audit_date.presence || '' %></span>
                                </div>
                              </div>
                              <hr class="form-hr">

                              <div class="row">
                                <div class="col-md-6">
                                  <label for="">Auditor:</label>
                                </div>
                                <div class="col-md-6">
																	<span class="font-bold" id="rva_information_auditor"><%= @last_rva_information&.auditor.presence || '' %></span>
                                </div>
                              </div>
                              <hr class="form-hr">

                              <div class="form-row row">
                                <div class="col-xl-12">
                                  <%= f.label :audit_comments, 'Comments:' %>
																	<%= f.text_area :audit_comments, rows: 3, class: 'form-control', value: @last_rva_information&.audit_comments %>
                                </div>
                              </div>

                              <div class="d-flex justify-content-end gap-2 mt-3">
                                <%= f.button 'Save Audit', class: 'btn btn-primary py-1', id: 'audit-btn' %>
                              </div>
                            </div>
                          </div>
                        </div>
                      <% end %>  
                    </div>
                  </div>
                </div>
              </div>
            </div>

	<!-- Verification Letter Modal -->
	<div class="modal fade" id="verifLetterModal" tabindex="-1" aria-labelledby="exampleModalLabel"
		aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-body">
					<div class="content">
						<div class="modal-title">
							<h6 class="offset-md-3">License Verification Letter</h6>
							<button class="btn btn-cancel" data-bs-dismiss="modal">Cancel</button>
						</div>
						<div class="mt-3 left-pane">
							<h6>Preview Letter</h6>
						</div>
						<div class="form-row row page-applicable mt-3">
							<div class="col-xl-12">
								<div class="card other-name-card">
									<div class="card-body">
										<h6 class="form-heading">Send Fax</h6>
										<span class="page-note mt-1">
											<i class='bx bx-error-circle font-red'></i> <span>Please correct the invalid fax number  Fields will be enabled once corrected.</span>
										</span>
										<div class="form-row mt-2">
											<label for="">Fax2Mail Email Address:</label>
											<input type="text" id="fax-email" name="fax-email" class="form-control" placeholder="Type here...">
										</div>
										<div class="form-row d-flex justify-content-end mt-4">
											<button class="btn btn-primary py-1">
												Send Fax
											</button>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="form-row row page-applicable mt-3">
							<div class="col-xl-12">
								<div class="card other-name-card">
									<div class="card-body">
										<h6 class="form-heading">Send Email</h6>
										<span class="page-note mt-1">
											<i class='bx bx-error-circle font-red'></i> <span>Please correct the invalid email address. Fields will be enabled once corrected.</span>
										</span>
										<div class="form-row mt-2">
											<label for="">Email Address To:</label>
											<input type="text" id="email-to" name="email-to" class="form-control" placeholder="Type here...">
										</div>
										<div class="form-row">
											<label for="">Email Address CC:</label>
											<input type="text" id="email-cc" name="email-cc" class="form-control" placeholder="Type here...">
										</div>
										<div class="form-row d-flex justify-content-end mt-4">
											<button class="btn btn-primary py-1">
												Send Email
											</button>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	</div>
	</div>
<script type="text/javascript">
    $(document).ready(function() {

        // send request parameter
        $('#send-request-btn').click(function (e) {
          e.preventDefault();
          var firstName = $('#firstname').html().trim();
					var personalInfoId = $('input[name="personal_info_id"]').val();
          var providerLicensureId = $('input[name="practice_licensure_id"]').val();

          $('.loading-overlay').show();

          $.ajax({
            url: '/webscrapers/send_licensure_request',
            method: 'POST',
            headers: {
              'X-CSRF-Token': $('meta[name="csrf-token"]').attr('content'),
            },
            data: {
              first_name: firstName,
							personal_info_id: personalInfoId,
							licensure_id: providerLicensureId
            },
            success: function (response) {
              // set the values
              const data =  response.rva_information;
							document.querySelector('[name="id"]').value = data.id;
              $('#send-request-btn').attr('disabled', 'true');
              $('#send-request-btn')[0].classList.remove('btn');
              $('.sent-request')[0].innerHTML = data.send_request;
              $('.requested-by')[0].innerHTML = data.requested_by;
              $('.requested-date')[0].innerHTML = data.requested_date;
              $(`#method-${data.requested_method}`).checked = true;
              $('.req-fee-amount')[0].value = data.required_fee_amount;
              $('input[name="check_generated"]').checked = data.required_fee_amount;
              $('.received-by')[0].innerHTML = data.received_by;
              $('.received-date')[0].innerHTML = data.received_date;
              $('input[name="received_status"]').checked = data.received_status;
              $('.request-comment')[0].value = data.comments;
              $('.loading-overlay').hide();
            },
            error: function () {
            },
          });
        });

				// Run Licensure Webcrawler
		$('#run-licensure-webcrawler-btn').click(function (e) {
          e.preventDefault();
          var personalInfoId = $('input[name="personal_info_id"]').val();
		      var licenseNumber = $('#license_number').val().trim();
          var providerLicensureId = $('input[name="practice_licensure_id"]').val();

          if (!licenseNumber) {
            $('#qaModalMessage').text('Crawling failed due to some error: First name or last name is missing.');
            return;
          }

          $('.loading-overlay').show();

          $.ajax({
            url: '/webscrapers/run_licensure_webcrawler',
            method: 'POST',
            headers: {
              'X-CSRF-Token': $('meta[name="csrf-token"]').attr('content'),
            },
            data: {
              info_id: personalInfoId,
			        license_number: licenseNumber, 
			        provider_licensure_id: providerLicensureId
            },
            success: function (response) {
              // set the values
              const crawlerData = response.webscraper_log;

              // Ensure crawlerData and its properties are defined before proceeding
              if (crawlerData && crawlerData.filepath && crawlerData.filepath.url && crawlerData.created_at) {
                  const createdDate = new Date(crawlerData.created_at); // Convert to a Date object if it's a string

                  // Construct HTML dynamically
                  const crawlerLinkHTML = `
                      <div class="row justify-content-end">
                          <div class="col-md-6">
                              <div class="text-decoration-underline">
                                  <a href="${crawlerData.filepath.url}" target="_blank">
                                      ${crawlerData.filepath.url.split('/').pop()}
                                  </a>
                              </div>
                          </div>
                          <div class="col-md-3">
                              <div class="date-time d-flex">
                                  <span>${createdDate.toISOString().split('T')[0]}</span> <!-- YYYY-MM-DD -->
                                  <span class="ms-2">${createdDate.toTimeString().slice(0, 5)}</span> <!-- HH:MM -->
                              </div>
                          </div>
                      </div>`;

                  // Inject the HTML into the #licensure-crawler-link element
                  document.getElementById('licensure-crawler-link').insertAdjacentHTML('afterbegin', crawlerLinkHTML);
              } else {
                  console.error('Crawler data is missing or incomplete.');
              }
              $('#rva_information_source_date').removeAttr('disabled');
              const data = response.rva_information;
              document.querySelector('[name="id"]').value = data.id;
              $('#send-request-btn').attr('disabled', 'false');
              $('#send-request-btn')[0].classList.remove('btn');
              $('.sent-request')[0].innerHTML = data.send_request;
              $('.requested-by')[0].innerHTML = data.requested_by;
              $('.requested-date')[0].innerHTML = data.requested_date;
              $(`#method-${data.requested_method}`).checked = true;
              $('.req-fee-amount')[0].value = data.required_fee_amount;
              $('input[name="check_generated"]').value = data.required_fee_amount;
              $('.received-by')[0].innerHTML = data.received_by;
              $('.received-date')[0].innerHTML = data.received_date;
              $('input[name="received_status"]').value = data.received_status;
              $('.request-comment')[0].value = data.comments;
              $('.loading-overlay').hide();
            },
            error: function () {
            },
          });
        });

        $('#verification-btn').click(function(e) {
          e.preventDefault(); // Prevent default form submission
					  // Check if source_date is filled
						if (!$('#rva_information_source_date').val()) {
							alert("Please select a Source Date before saving.");
							return;
						}

          // Serialize the form data from #audit-form
          const auditFormData = $('#audit-form').serialize();
          const additionalParams = 'section=audit'; 


          // Combine the form data and additional data into a single object
          $.ajax({
            url: '/mhc/verification-platform/generate_rva_information',
            method: 'POST',
            headers: {
              'X-CSRF-Token': $('meta[name="csrf-token"]').attr('content'),
            },
            data: `${auditFormData}&section=verification`, // Combine serialized data
            success: function(response) {
              // Handle success (e.g., display a success message)
              const data = response.rva_information;
              $('input[name="rva_information[audit_status]"]').removeAttr('disabled')
              $('#rva_information_source_name').attr('disabled', true);
              $('#rva_information_source_date').attr('disabled', true);
              $('#rva_information_status').attr('disabled', true);
              $('#rva_information_other_details').attr('disabled', true);
              $('.verification-status')[0].innerHTML = data.verification_status;
              $('.verification-date')[0].innerHTML = data.verification_date;
              $('.verifier')[0].innerHTML = data.verifier;
              $('#rva_information_verification_comments')[0].value = data.verification_comments;
              $(`#verif-${data.adverse_action_status}`).checked = data.adverse_action_status;
              $('input[name="rva_information[in_good_standing]"]').checked = data.in_good_standing;
            },
            error: function(xhr, status, error) {
              console.error('Error:', error);
            }
          });
        });
        $('#audit-btn').click(function(e) {
          e.preventDefault(); // Prevent default form submission
					  // Check if an audit status is selected
						if (!$('input[name="rva_information[audit_status]"]:checked').val()) {
							alert("Please select an Audit Status before saving.");
							return;
						}

          // Serialize the form data from #audit-form
          const auditFormData = $('#audit-form').serialize();
					var practiceInfoEducationId = $('input[name="practice_licensure_id"]').val();

          // Combine the form data and additional data into a single object
          $.ajax({
            url: '/mhc/verification-platform/generate_rva_information',
            method: 'POST',
            headers: {
              'X-CSRF-Token': $('meta[name="csrf-token"]').attr('content'),
            },
						data: `${auditFormData}&section=audit&practice_licensure_id=${practiceInfoEducationId}`, // Combine serialized data
            success: function(response) {
              const data = response.rva_information;
              $('input[name="rva_information[audit_status]"]').value = data.audit_status;
              $('#rva_information_audit_date')[0].innerHTML = data.audit_date;
              $('#rva_information_auditor')[0].innerHTML = data.auditor;
              $('#rva_information_audit_comments')[0].value = data.audit_comments;
              $('#re-rva')[0].classList.remove('d-none');
            },
            error: function(xhr, status, error) {
              console.error('Error:', error);
            }
          });
        });
      });

    var csrfToken = $('meta[name="csrf-token"]').attr('content');

    $("#ajaxForm").submit(function(e){
        e.preventDefault();
        var action = $(this).attr("action");
        var formData = new FormData(this)
        formData.append('authenticity_token', csrfToken);
        $.ajax({
            type: "POST",
            url: action,
            crossDomain: true,
            data: formData,
            dataType: "json",
            contentType: "multipart/form-data",
            processData: false,
            contentType: false,
            headers: {
                "Accept": "application/json"
            }
        }).done(function() {
            $('#btn-modal-close').trigger('click');
            $('.loading-overlay').hide();
        }).fail(function() {
            alert('An error occurred.')
            $('.loading-overlay').hide();
        });
    });
  document.addEventListener('DOMContentLoaded', function() {
    const qualityAuditModal = document.getElementById('QAModal');
    qualityAuditModal.addEventListener('show.bs.modal', function (event) {
      const button = event.relatedTarget; 
      const FirstName = button.getAttribute('data-first-name');
      const LastName = button.getAttribute('data-last-name');
      const InformationId = button.getAttribute('data-information-id');
      const personalInfoId = button.getAttribute('data-personal-information-id');
	    const practiceInfoEducationId = button.getAttribute('data-licensure-id');

      // Update the hidden field in the form with the document ID
      document.querySelector('[name="first_name"]').value = FirstName;
      document.querySelector('[name="last_name"]').value = LastName;
      document.querySelector('[name="id"]').value = InformationId;
      document.querySelector('[name="personal_info_id"]').value = personalInfoId;
	  document.querySelector('[name="practice_licensure_id"]').value = practiceInfoEducationId;
    });
  });
</script>
