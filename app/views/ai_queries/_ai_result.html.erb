<% display_columns = [] %>
<% if @records.present? && @records.first.present? %>
  <% if @display_specific_license_column.present? %>
    <% display_columns = @records.first.class.displayable_attributes.dup %>
    <% display_columns << @display_specific_license_column %>
    <% display_columns.uniq! %>
  <% else %>
    <% display_columns = @records.first.class.respond_to?(:displayable_attributes) ? @records.first.class.displayable_attributes : [] %>
  <% end %>

  <div class="">
    <h4 class="mb-3 text-secondary">Results: <%= @records.first.class.name.pluralize %></h4>

    <div class="table-responsive rounded border">
      <table class="table table-hover align-middle mb-0">
        <thead class="table-light">
          <tr>
            <% display_columns.each do |column| %>
              <th class="text-uppercase small fw-bold text-muted"><%= column.to_s.titleize %></th>
            <% end %>
          </tr>
        </thead>
        <tbody>
          <% @records.each do |record| %>
            <tr>
              <% display_columns.each do |column| %>
                <td class="text-break" style="max-width: 250px;">
                  <% if column.to_s.ends_with?('_expiration_date') || column.to_s.ends_with?('_effective_date') %>
                    <%= record.send(column) if record.respond_to?(column) %>
                  <% elsif column == :bc_expiration_date && record.respond_to?(:board_certifications) %>
                    <%= record.board_certifications.first.try(:bc_expiration_date) %>
                  <% elsif column == :bc_effective_date && record.respond_to?(:board_certifications) %>
                    <%= record.board_certifications.first.try(:bc_effective_date) %>
                  <% else %>
                    <%= record.send(column) %>
                  <% end %>
                </td>
              <% end %>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>

    <div class="mt-3 d-flex justify-content-between align-items-center py-3">
      <div class="">
        <%= page_entries_info @records %>
      </div>
      <div>
        <%= will_paginate @records, renderer: WillPaginate::ActionView::BootstrapLinkRenderer %>
      </div>
    </div>
  </div>
<% elsif @input.present? %>
  <p class="alert alert-warning mt-4">No results found for "<%= @input %>". Please try a different query.</p>
<% end %>
