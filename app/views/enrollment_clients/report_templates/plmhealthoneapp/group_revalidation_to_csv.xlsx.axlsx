wb = xlsx_package.workbook
s = wb.styles
header = s.add_style sz: 14, b: true, bg_color: "6EAA46", fg_color: "FFFFFF", alignment: { wrap_text: true, vertical: :center }
wb.add_worksheet(name: "Post") do |sheet|
  sheet.add_row ["Platform", "Group Name", "NPI", "(Payor)1", "State", "(Payor)\nProvider ID", "(Payor)\nProvider\nEffective Date",
              "(Payor)\nProvider\nRevalidation\nDate", "(Payor)2","State", "(Payor)\nProvider ID", "(Payor)\nProvider\nEffective Date",
              "(Payor)\nProvider\nRevalidation\nDate"], style: header, height: 70
  @enrollment_details.each do |enrollment_detail|
    enroll_group = enrollment_detail.enroll_group
    group = enroll_group&.group
    sheet.add_row [
      flatforms.detect{|flatform| flatform.last == group&.flatform }&.first,
      group&.group_name,
      group&.npi_digit_type,
      enrollment_detail.enrollment_payer,
      enrollment_detail.payer_state,
      enrollment_detail.group_number,
      enrollment_detail.effective_date&.strftime('%b %d, %Y'),
      enrollment_detail.revalidation_date&.strftime('%b %d, %Y'),
      enrollment_detail.enrollment_payer,
      enrollment_detail.payer_state,
      enrollment_detail.group_number,
      enrollment_detail.effective_date&.strftime('%b %d, %Y'),
      enrollment_detail.revalidation_date&.strftime('%b %d, %Y')
    ], types: [:string, :string, :string, :string, :string, :string, :string, :string, :string, :string, :string, :string, :string]
  end
  sheet.column_widths 12, 18, 16, 18, 12, 16, 16, 16, 18, 12, 16, 16, 16
end