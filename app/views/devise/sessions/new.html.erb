<div class="container" style="height: 100vh;">
   <div class="row d-flex justify-content-center align-items-center pt-3">
      <div class="col-lg-5 my-3">
         <div class="card px-5">
            <div class="card-body">
               <div class="d-flex justify-content-center gap-2 align-items-center">
                <% if current_setting.mhc? %>
                  <img src="<%= current_logo %>" style="<%= current_setting.plmhealthoneapp? ? 'height: 100%;' : 'width:50%;'%>" class="mt-3"> 
                <% else %>
                  <img src="<%= current_logo %>" style="<%= current_setting.plmhealthoneapp? ? 'height: 100%;' : 'width:100%;'%>" class="mt-3">
                <% end %>
               </div>
               <div class="d-flex justify-content-start my-3">
                  <h3>Sign In</h3>
               </div>

               <%= form_for(resource, as: resource_name, url: session_path(resource_name)) do |f| %>
               <% if flash[:alert] %>
               <div id="error_explanation" data-turbo-cache="false">
                  <small class="text-danger">
                     <%= flash[:alert] %>
                  </small>
               </div>
               <% end %>

               <div class="form-group my-3">
                  <%= f.email_field :email, autofocus: true, autocomplete: "email", class: 'form-control', placeholder: 'Email' %>
               </div>
                <div class="form-group mt-3 mb-2 position-relative">
                  <%= f.password_field :password, autocomplete: "current-password", class: 'form-control pe-5', placeholder: 'Password', id: 'password-field' %>

                  <button type="button"
                          class="btn btn-link position-absolute top-50 end-0 translate-middle-y me-3 p-0 border-0"
                          onclick="togglePasswordVisibility()" 
                          style="z-index: 10; outline: none; box-shadow: none;">
                    <i class="bi bi-eye fs-5" id="togglePasswordIcon"></i>
                      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
                  </button>
                </div>
                <div class="form-group mt-2">
                  <label for="captcha_answer" class="form-label">
                    What is <%= session[:captcha_num1] %> + <%= session[:captcha_num2] %>?
                  </label>
                  <%= text_field_tag :captcha_answer, nil, class: 'form-control', placeholder: 'Enter the answer', id: 'captcha_answer' %>
                </div>        
               <div class="d-flex justify-content-start">
                  <%- if devise_mapping.recoverable? && controller_name != 'passwords' && controller_name != 'registrations' %>
                    <%= link_to "Having trouble signing in?", new_password_path(resource_name), style: 'text-decoration: none;color: #555;' %>
                  <% end %>
               </div>
               <div class="d-flex flex-column gap-3 justify-content-center align-items-center my-5">
																	<div>
																				<%= f.submit "Sign in", class: 'btn btn-primary btn-lg py-3 px-5 fs-6'%>
																	</div>
               </div>
               <% end %>
            </div>
         </div>
      </div>
   </div>
</div>
<script>
  function togglePasswordVisibility() {
    const passwordField = document.getElementById("password-field");
    const toggleIcon = document.getElementById("togglePasswordIcon");

    if (passwordField.type === "password") {
      passwordField.type = "text";
      toggleIcon.classList.remove("bi-eye");
      toggleIcon.classList.add("bi-eye-slash");
    } else {
      passwordField.type = "password";
      toggleIcon.classList.remove("bi-eye-slash");
      toggleIcon.classList.add("bi-eye");
    }
  }
</script>
