<div class="content container-fluid">
  <%= render "enrollment_tracking_components/enrollment_nav"%>

   <div class="row" id="overview">
      <div class="col-lg-9">
         <h2>Dashboard Overview</h2>
         <div class="row mb-3">
            <div class="col-lg-4 mb-3">
               <div class="card p-2">
                  <%= link_to providers_url do %>
                  <h3 class="text-primary">Providers</h3>
                  <% end %>
                  <h5 class="text-white">spacer</h5>
                  <div class="w-100 d-flex justify-content-center align-items-center" style="height: 100px;">
                     <%= link_to providers_url do %>
                     <h1 style="font-size: 40px;">
                        <%= Provider.count %>
                     </h1>
                     <% end %>
                  </div>
               </div>
            </div>
            <div class="col-lg-4 mb-3">
               <div class="card p-2">
                  <%= link_to groups_enrollments_path do %>
                  <h3 class="text-primary">Groups</h3>
                  <% end %>
                  <h5 class="text-white">spacer</h5>
                  <div class="w-100 d-flex justify-content-center align-items-center" style="height: 100px;">
                     <%= link_to groups_enrollments_path do %>
                     <h1 style="font-size: 40px;">
                        <%= EnrollmentGroup.count %>
                     </h1>
                     <% end %>
                  </div>
               </div>
            </div>
            <div class="col-lg-4 mb-3">
               <div class="card p-2">
                <div class="d-flex justify-content-between">
                  <%= link_to groups_enrollments_path do %>
                  <h3 class="text-primary">Group's DCO</h3>
                  <% end %>
                  <select class="dco-select">
                    <option value="all">All</option>
                    <% enrollment_group_options.each do |group|%>
                      <option value="<%= group[1]%>"><%= group[0]%></option>
                    <% end %>
                  </select>
                </div>
                  <h5 class="text-white">spacer</h5>
                  <div class="w-100 d-flex justify-content-center align-items-center" style="height: 100px;">
                     <%= link_to groups_enrollments_path do %>
                     <h1 style="font-size: 40px;" id="group_dco_counter">
                        <%= GroupDco.count %>
                     </h1>
                     <% end %>
                  </div>
               </div>
            </div>
            <div class="col-lg-4 mb-3">
               <div class="card p-2">
                  <%= link_to groups_enrollments_path do %>
                  <h3 class="text-primary">Pending Enrollments</h3>
                  <% end %>
                  <div class="d-flex gap-2">
                     <a href="javascript:void(0);" class="enrollment-by-status" data-model="enrollment_providers" data-status="pending"><h5 class="text-primary">Providers</h5></a>
                     <a href="javascript:void(0);" class="enrollment-by-status" data-model="enroll_groups" data-status="pending"><h5>Groups</h5></a>
                  </div>
                  <div class="w-100 d-flex justify-content-center align-items-center flex-column" style="height: 100px;">
                     <%= link_to groups_enrollments_path do %>
                     <h1 style="font-size: 40px;" id="pending_enrollment_ctr">
                        <%= EnrollmentProvider.pending.count %>
                     </h1>
                     <% end %>
                      <p>
                       <a class="text-white" href="javascript:void(0);">See more</a>
                     </p>
                  </div>
               </div>
            </div>
            <div class="col-lg-4">
               <div class="card p-2">
                  <%= link_to groups_enrollments_path do %>
                  <h3 class="text-primary">Completed Enrollments</h3>
                  <% end %>
                  <div class="d-flex gap-2">
                     <a href="javascript:void(0);"  class="enrollment-by-status" data-model="enrollment_providers" data-status="completed"><h5 class="text-primary">Providers</h5></a>
                     <a href="javascript:void(0);"  class="enrollment-by-status" data-model="enrollment_group" data-status="completed"><h5>Groups</h5></a>
                  </div>
                  <div class="w-100 d-flex justify-content-center align-items-center flex-column" style="height: 100px;">
                     <%= link_to groups_enrollments_path do %>
                     <h1 style="font-size: 40px;"  id="completed_enrollment_ctr">
                        <%= EnrollmentProvider.completed.count %>
                     </h1>
                     <% end %>
                     <p>
                       <a href="<%= groups_enrollments_path %>">See more</a>
                     </p>
                  </div>
               </div>
            </div>
            <div class="col-lg-4">
               <div class="card p-2">
                <!-- dont know where this leads -->
                  <%= link_to providers_url do %>
                  <h3 class="text-primary">Scheduled Callbacks</h3>
                  <% end %>
                  <h5 class="text-white">spacer</h5>
                  <div class="w-100 d-flex justify-content-center align-items-center flex-column" style="height: 100px;">
                     <%= link_to providers_url do %>
                     <h1 style="font-size: 40px;">
                        <%= EnrollmentProvider.callback.count %>
                     </h1>
                     <% end %>
                     <p>
                       <a href="<%= providers_url %>">See more</a>
                     </p>
                  </div>
               </div>
            </div>
         </div>

         <div class="row mb-3">
           <div class="col-lg-12">
             <h2>Enrollment Payer</h2>
           </div>
           <div class="col-lg-4 mb-3">
             <select class="form-select border-dark" id="payer_selector">
               <option value="">Select Option</option>
               <% enrollment_provider_options.each do |provider|%>
                <option value="<%= provider[1]%>"><%= provider[0]%></option>
               <% end %>
             </select>
           </div>
           <div class="col-lg-12">
             <div class="row gap-1">

            <div class="col-lg-2 mb-3">
               <div class="card p-2">
                  <%= link_to providers_url do %>
                  <h6 class="text-primary">Submitted</h6>
                  <% end %>
                  <h5 class="text-white">spacer</h5>
                  <div class="w-100 d-flex justify-content-center align-items-center" style="height: 100px;">
                     <%= link_to providers_url do %>
                     <h1 style="font-size: 40px;" id="payer_submitted">
                        <%= EnrollmentProvidersDetail.submitted.count %>
                     </h1>
                     <% end %>
                  </div>
               </div>
            </div>


            <div class="col-lg-2 mb-3">
               <div class="card p-2">
                  <%= link_to providers_url do %>
                  <h6 class="text-primary">Processing</h6>
                  <% end %>
                  <h5 class="text-white">spacer</h5>
                  <div class="w-100 d-flex justify-content-center align-items-center" style="height: 100px;">
                     <%= link_to providers_url do %>
                     <h1 style="font-size: 40px;" id="payer_processing">
                        <%= EnrollmentProvidersDetail.processing.count %>
                     </h1>
                     <% end %>
                  </div>
               </div>
            </div>
            <div class="col-lg-2 mb-3">
               <div class="card p-2">
                  <%= link_to providers_url do %>
                  <h6 class="text-primary">Approved</h6>
                  <% end %>
                  <h5 class="text-white">spacer</h5>
                  <div class="w-100 d-flex justify-content-center align-items-center" style="height: 100px;">
                     <%= link_to providers_url do %>
                     <h1 style="font-size: 40px;" id="payer_approved">
                        <%= EnrollmentProvidersDetail.approved.count %>
                     </h1>
                     <% end %>
                  </div>
               </div>
            </div>

            <div class="col-lg-2 mb-3">
               <div class="card p-2 px-1">
                  <%= link_to providers_url do %>
                  <h6 class="text-primary">Denied</h6>
                  <% end %>
                  <h5 class="text-white">spacer</h5>
                  <div class="w-100 d-flex justify-content-center align-items-center" style="height: 100px;">
                     <%= link_to providers_url do %>
                     <h1 style="font-size: 40px;" id="payer_denied">
                        <%= EnrollmentProvidersDetail.denied.count %>
                     </h1>
                     <% end %>
                  </div>
               </div>
            </div>
            <div class="col-lg-2 mb-3">
               <div class="card p-2">
                  <%= link_to providers_url do %>
                  <h6 class="text-primary">Terminated</h6>
                  <% end %>
                  <h5 class="text-white">spacer</h5>
                  <div class="w-100 d-flex justify-content-center align-items-center" style="height: 100px;">
                     <%= link_to providers_url do %>
                     <h1 style="font-size: 40px;" id="payer_terminated">
                        <%= EnrollmentProvidersDetail.terminated.count %>
                     </h1>
                     <% end %>
                  </div>
               </div>
            </div>
             </div>
           </div>

         </div>
      </div>
      <div class="col-lg-3 border rounded py-2">
        <div class="row">
          <div class="col-12 mb-3">
            <h5 class="text-center">Available Agents</h5>
          </div>
          <div class="col-12 mb-3">
            <input type="" class="form-control" title="Search">
          </div>

          <div class="col-12 mb-3">
            <div class="bg-medium-grey rounded d-flex justify-content-between px-2 py-2 align-items-center">
              <div>
                <h4>John Bard</h4>
                <h6 class="text-primary">Administrator</h6>
              </div>
              <span>
                Offline/Online
              </span>
            </div>
          </div>
        </div>
      </div>
   </div>
</div>
<script>
var csrfToken = $('meta[name="csrf-token"]').attr('content');

  $('.dco-select').on('change',function() {
    var group_id = $(this).val();

    $.ajax({
      url: '<%= get_group_dcos_path %>',
      method: 'POST',
      data: { authenticity_token: csrfToken, group_id: group_id },
      success: function(data) {
        var group_dco = data['group_dco'];
        $('#group_dco_counter').html(group_dco);
      }
    })
  })

  $('#payer_selector').on('change',function() {
    var provider_id = $(this).val();
    // alert(provider_id)
    if(provider_id != '') {
      $.ajax({
        url: '<%= get_provider_payers_path %>',
        method: 'POST',
        data: { authenticity_token: csrfToken, provider_id: provider_id },
        success: function(data) {
          $('#payer_submitted').html(data['submitted']);
          $('#payer_processing').html(data['processing']);
          $('#payer_approved').html(data['approved']);
          $('#payer_denied').html(data['denied']);
          $('#payer_terminated').html(data['terminated']);
        }
      })
    }
  })

  $('.enrollment-by-status').on('click',function() {
    var model = $(this).data('model');
    var status = $(this).data('status');
    $.ajax({
      url: '<%= get_enrollment_status_count_path %>',
      method: 'POST',
      data: { authenticity_token: csrfToken, model: model, status: status },
      success: function(data) {
        $('#'+status+'_enrollment_ctr').html(data['count']);
      }
    })
    changeTextColorEnrollmentStatus($(this));
  })

  function changeTextColorEnrollmentStatus(link) {
    link.parent().find('a').find('h5').removeClass('text-primary');
    link.find('h5').addClass('text-primary');
  }
</script>